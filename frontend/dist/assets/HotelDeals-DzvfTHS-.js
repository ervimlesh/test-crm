import{j as t,b as U,V as T,r as l,o as z,p as G}from"./index-DDoEHnfR.js";import{L as J}from"./Layout-Co7qzEc2.js";import{S as K}from"./SideBar-DCoEgSRU.js";import{D as _}from"./index.es-_Aq59fjB.js";/* empty css                         */import{E as W}from"./jspdf.es.min-CSfEVfgj.js";import"./clsx-B-dksMZM.js";const q=({hotelDealsPop:g,deals:e,onClose:A,fetchHotelDeals:p})=>{if(!g||!e)return null;const u=e.createdAt?new Date(e.createdAt).toLocaleString():"N/A",i=()=>{var d,o,h,a,x;const n=new W;n.setFontSize(12),n.text("Flight Details",10,10),n.text(`Booking ID: ${e.bookingId||"N/A"}`,10,20),n.text(`First Name: ${e.firstName||"N/A"}`,10,30),n.text(`Mobile: ${e.mobile||"N/A"}`,10,40),n.text(`Email: ${e.email||"N/A"}`,10,50),n.text(`Card Holder Name: ${e.cardHolderName||"N/A"}`,10,60),n.text(`Card Number: ${e.cardNumber||"N/A"}`,10,70),n.text(`City: ${e.city||"N/A"}`,10,80),n.text(`Country: ${e.country||"N/A"}`,10,90),n.text(`Adult: ${e.adt||"N/A"}`,10,100),n.text(`Infant: ${e.ift||"N/A"}`,10,110),n.text(`Created At: ${u}`,10,120),n.text(`Currency: ${e.currency||"N/A"}`,10,130),n.text(`DOB: ${e.dob||"N/A"}`,10,140),n.text(`From: ${((d=e==null?void 0:e.flight)==null?void 0:d.cityFrom)||"N/A"} (${((o=e==null?void 0:e.flight)==null?void 0:o.flyFrom)||"N/A"})`,10,150),n.text(`To: ${((h=e==null?void 0:e.flight)==null?void 0:h.cityTo)||"N/A"} (${((a=e==null?void 0:e.flight)==null?void 0:a.flyTo)||"N/A"})`,10,160),n.text(`Price: ${((x=e==null?void 0:e.flight)==null?void 0:x.price)||"N/A"}`,10,170),n.text(`Postal Code: ${e.postalCode||"N/A"}`,10,180),n.text(`State: ${e.state||"N/A"}`,10,190),n.text(`Total Amount: ${e.totalAmount||"N/A"}`,10,200),n.text(`Status: ${e.status||"N/A"}`,10,210),n.save(`FlightDetails_${e.bookingId||"N/A"}.pdf`)},k=async(n,d)=>{const o=await U.patch(`/api/v1/hotels/status/${n}`,{status:d});o&&o.data.success?(T.success(o.data.message),await p(),e._id===n&&(e.status=d)):T.error(o.data.message||"Something went wrong!")};return t.jsx(t.Fragment,{children:t.jsx("div",{className:"popup-overlay",children:t.jsxs("div",{className:"popup-content",id:"printable-popup",children:[t.jsx("button",{className:"close-btn",onClick:A,children:" Ã— "}),t.jsx("h2",{children:"Hotel Details"}),t.jsxs("p",{children:[" ",t.jsx("strong",{children:"ID:"}),e._id]}),t.jsxs("p",{children:[t.jsx("strong",{children:"First Name:"})," ",e.firstName]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Mobile:"})," ",e.mobile]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Email:"})," ",e.email]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Card Holder Name:"})," ",e.cardHolderName]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Card Number:"})," ",e.cardNumber]}),t.jsxs("p",{children:[t.jsx("strong",{children:"City:"})," ",e.city]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Country:"})," ",e.country]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Status:"})," ",e.status]}),t.jsxs("p",{children:[t.jsx("strong",{children:"address:"})," ",e.address]}),t.jsxs("p",{children:[t.jsx("strong",{children:"adult:"})," ",e.adult]}),t.jsxs("p",{children:[t.jsx("strong",{children:"infant:"})," ",e==null?void 0:e.infant]}),t.jsxs("p",{children:[t.jsx("strong",{children:"child:"})," ",e.child]}),t.jsxs("p",{children:[t.jsx("strong",{children:"org:"})," ",e.org]}),t.jsxs("p",{children:[t.jsx("strong",{children:"cardDetails:"})," ",e.cardDetails]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Created At:"})," ",u]}),t.jsx("p",{children:e.status==="newBooking"?t.jsxs("div",{className:"dropdown",children:[t.jsx("button",{className:"btn btn-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"New Booking"}),t.jsxs("ul",{className:"dropdown-menu",children:[t.jsx("li",{children:t.jsx("button",{className:"dropdown-item",onClick:()=>k(e._id,"approved"),children:"Approve"})}),t.jsx("li",{children:t.jsx("button",{className:"dropdown-item",onClick:()=>k(e._id,"rejected"),children:"Reject"})})]})]}):t.jsx("button",{className:`btn ${e.status==="approved"?"text-success":e.status==="rejected"?"text-danger":"text-primary"}`,disabled:!0,children:e.status||"New Booking"})}),t.jsx("button",{className:"btn btn-warning p ",onClick:i,children:"Download"})]})})})};G();const nt=()=>{const[g,e]=l.useState(!1),[A,p]=l.useState(null),{fetchHotelDeals:u,hotelDeals:i,setHotelDeals:k,errorCode:n,loading:d}=z(),[o,h]=l.useState(i),[a,x]=l.useState(1),[N,F]=l.useState(null),[f,P]=l.useState(null),[b,E]=l.useState(""),[C,M]=l.useState(!0),D=5,m="newBooking",y="rejected";l.useEffect(()=>{u()},[]),l.useEffect(()=>{},[]),l.useEffect(()=>{O()},[N,f,b,i]);const O=()=>{let s=i;N&&(s=s.filter(r=>new Date(r.createdAt)>=new Date(N))),f&&(s=s.filter(r=>new Date(r.createdAt)<=new Date(f))),b.trim()&&(s=s.filter(r=>{var j;return(j=r.bookingId)==null?void 0:j.includes(b.trim())})),h(s)},B=()=>{F(null),P(null),E(""),h(i)},w=s=>{let r;const j=new Date().toISOString().split("T")[0];switch(s){case"today":r=i.filter(c=>new Date(c.createdAt).toISOString().split("T")[0]===j);break;case m:r=i.filter(c=>c.status===m);break;case y:r=i.filter(c=>c.status===y);break;default:r=i}h(r)},S=s=>{x(s)};l.useEffect(()=>{if(o.length>0){const s=Math.ceil(o.length/D);a>s?x(s):a<1&&x(1)}else x(1)},[a,o]);const L=()=>{M(!C)},H=Math.ceil(o.length/D),$=(a-1)*D,I=o.slice($,$+D),v=o.filter(s=>s.status===m).length,R=s=>{p(s),e(!0)},V=()=>{e(!1),p(null)};return t.jsxs(J,{children:[t.jsxs("div",{className:"d-flex",children:[t.jsx(K,{todayDealsCount:v}),t.jsxs("div",{className:"flex-grow-1 p-4",children:[t.jsx("h2",{className:"text-start",children:"All Hotel Details"}),t.jsxs("div",{className:"d-flex gap-2 mb-3",children:[t.jsxs("button",{className:"btn btn-danger",onClick:()=>w("today"),children:["Today's Booking:"," ",t.jsx("strong",{})]}),t.jsxs("button",{className:"btn btn-success",onClick:B,children:["Total Booking: ",t.jsx("strong",{children:i.length})]}),t.jsxs("button",{className:"btn btn-warning",onClick:()=>w(m),children:["New Booking:"," ",t.jsx("strong",{children:i.filter(s=>s.status===m).length})]}),t.jsxs("button",{className:"btn btn-danger",onClick:()=>w(y),children:["Rejected Booking:"," ",t.jsx("strong",{children:i.filter(s=>s.status===y).length})]})]}),C&&t.jsxs("div",{className:"alert alert-info",children:[v>0?t.jsxs(t.Fragment,{children:[t.jsxs("strong",{children:[t.jsx("span",{className:"badge bg-info text-dark fs-5",children:v})," ","Notifications"]}),t.jsx("ul",{children:o.filter(s=>s.status===m).map((s,r)=>t.jsxs("li",{children:[r+1,": Booking ID ",s.bookingId,":"," ",s.firstName," (",s.email,")"]},s._id))})]}):"No new bookings at the moment.",t.jsxs("button",{className:"btn btn-link text-dark",onClick:L,children:[C?"Hide":"Show"," Notifications"]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h5",{children:"Filter Options"}),t.jsxs("div",{className:"d-flex gap-3",children:[t.jsx(_,{selected:N,onChange:s=>F(s),placeholderText:"Start Date",dateFormat:"MM-dd-yyyy",className:"form-control",maxDate:new Date}),t.jsx(_,{selected:f,onChange:s=>P(s),placeholderText:"End Date",dateFormat:"MM-dd-yyyy",className:"form-control",maxDate:new Date}),t.jsx("input",{type:"text",value:b,onChange:s=>E(s.target.value),placeholder:"Enter Booking ID",className:"form-control"})]}),t.jsx("button",{className:"btn btn-secondary mt-3",onClick:B,children:"Clear Filters"})]}),t.jsxs("table",{className:"table table-striped table-bordered",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"#"}),t.jsx("th",{children:"First Name"}),t.jsx("th",{children:"Mobile"}),t.jsx("th",{children:"Email"}),t.jsx("th",{children:"Action"}),t.jsx("th",{children:"Status"})]})}),t.jsx("tbody",{children:I.length?I.map((s,r)=>t.jsxs("tr",{children:[t.jsx("td",{children:$+r+1}),t.jsx("td",{children:s.firstName}),t.jsx("td",{children:s.mobile}),t.jsx("td",{children:s.email}),t.jsx("td",{className:"d-flex gap-1",children:t.jsx("button",{className:"btn btn-primary text-nowrap",onClick:()=>R(s),children:"View Details"})}),t.jsx("td",{children:t.jsx("span",{className:`${s.status==="approved"?"text-success":s.status==="rejected"?"text-danger":"text-primary"}`,children:s.status})})]},s._id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"6",className:"text-center",children:d?"Loading...":n||"No flight deals available."})})})]}),t.jsxs("div",{className:"pagination mt-3",children:[t.jsx("button",{className:"btn btn-secondary mx-1",onClick:()=>S(a-1),disabled:a<=1,children:"Prev"}),Array.from({length:3},(s,r)=>{const j=r-0,c=a+j;return c<1||c>H?null:t.jsx("button",{className:`btn ${a===c?"btn-primary":"btn-secondary"} mx-1`,onClick:()=>S(c),children:c},c)}),t.jsx("button",{className:"btn btn-secondary mx-1",onClick:()=>S(a+1),disabled:a>=H,children:"Next"})]})]})]}),g&&t.jsx(q,{hotelDealsPop:g,deals:A,onClose:V,fetchHotelDeals:u})]})};export{nt as default};
