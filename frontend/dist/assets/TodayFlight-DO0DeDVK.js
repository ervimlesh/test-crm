import{f as g,r as h,u as b,j as t,N as f}from"./index-DDoEHnfR.js";import{L as D}from"./Layout-Co7qzEc2.js";import{S as y}from"./SideBar-DCoEgSRU.js";const v=()=>{var m;const{ctmFlightDeals:r,fetchCtmFlightDeals:n}=g(),[c,u]=h.useState([]),{auth:s,setAuth:N}=b();return h.useEffect(()=>{var a;if(!(s!=null&&s.user))return;const e=(a=s.user.role)==null?void 0:a.toLowerCase();if(e==="admin"||e==="superadmin"){const l=new Date().toLocaleDateString("en-CA"),i=r.filter(d=>{var x;if(!((x=d==null?void 0:d.outboundSegments)!=null&&x.length))return!1;const j=d.outboundSegments[0].departure;return new Date(j).toLocaleDateString("en-CA")===l});i.length>0&&u(i)}},[s,r]),h.useEffect(()=>{s!=null&&s.user&&n&&n()},[s]),t.jsx(t.Fragment,{children:t.jsx(D,{children:t.jsxs("main",{class:"crm_all_body d-flex",children:[t.jsx(y,{}),t.jsx("div",{className:"modal-body mt-5",children:c.length===0?t.jsx("p",{className:"text-muted text-center py-3",children:"No flights scheduled today."}):t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{className:"table table-striped table-hover align-middle table-bordered",children:[t.jsx("thead",{className:"table-dark text-center",children:t.jsxs("tr",{children:[t.jsx("th",{children:"BID"}),t.jsx("th",{children:"CCH NAME"}),t.jsx("th",{children:"PROVIDER"}),t.jsx("th",{children:"TRAVEL DATE"}),t.jsx("th",{children:"FROM"}),t.jsx("th",{children:"TO"}),t.jsx("th",{children:"Transaction Type"}),t.jsx("th",{children:"AGENT"}),t.jsx("th",{children:"Remark"}),t.jsx("th",{children:"Activity"})]})}),t.jsx("tbody",{children:(m=c==null?void 0:c.slice().sort((e,a)=>new Date(a.updatedAt)-new Date(e.updatedAt)))==null?void 0:m.map((e,a)=>{var o,l,i,d;return t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx(f,{to:`/ztsPage/details-pnr-flight/${e==null?void 0:e._id}`,className:"text-primary text-decoration-underline fw-semibold",children:e.bookingId})}),t.jsx("td",{children:e.cchName}),t.jsx("td",{children:e.provider.provider}),t.jsx("td",{children:e!=null&&e.outboundSegments?new Date((o=e==null?void 0:e.outboundSegments[0])==null?void 0:o.departure).toLocaleString():"N/A"}),t.jsx("td",{children:(l=e==null?void 0:e.outboundSegments[0])==null?void 0:l.from}),t.jsx("td",{children:(i=e==null?void 0:e.outboundSegments[(e==null?void 0:e.outboundSegments.length)-1])==null?void 0:i.to}),t.jsx("td",{children:t.jsx("span",{className:"badge bg-info text-dark",children:e.transactionType})}),t.jsx("td",{children:(d=e==null?void 0:e.agent)==null?void 0:d.userName}),t.jsx("td",{children:e==null?void 0:e.remarks}),t.jsx("td",{children:t.jsx("span",{className:`badge ${e!=null&&e.pnrRemark?"bg-success":"bg-secondary"}`,children:(e==null?void 0:e.pnrRemark)||"fresh booking"})})]},a)})})]})})})]})})})};export{v as default};
