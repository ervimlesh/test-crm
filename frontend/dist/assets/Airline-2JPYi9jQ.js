import{r as l,j as e,b as p,V as c}from"./index-DDoEHnfR.js";import{L as P}from"./Layout-Co7qzEc2.js";import{S as V}from"./SideBar-DCoEgSRU.js";const T=()=>{const[d,I]=l.useState([]),[E,u]=l.useState(!1),[o,_]=l.useState({ctmAirline:"",status:""}),[x,N]=l.useState(!1),[g,j]=l.useState([]),[A,f]=l.useState([]),[F,b]=l.useState(!1),[m,y]=l.useState({ctmAirline:"",status:""}),[k,D]=l.useState(null),[v,w]=l.useState(!1),h=async()=>{var t,a;try{const s=await p.get("/api/v1/ctmFlights/get-ctmAirline");s.data.success?(I((t=s==null?void 0:s.data)==null?void 0:t.booking),console.log((a=s==null?void 0:s.data)==null?void 0:a.booking)):console.error("Failed to fetch current ctmAirline percentage.")}catch(s){console.error("Error fetching current ctmAirline  percentage:",s)}};l.useEffect(()=>{h()},[]);const L=async t=>{var a,s;try{const r=await p.delete(`/api/v1/ctmFlights/delete-ctmAirline/${t}`);(a=r==null?void 0:r.data)!=null&&a.success?(c.success((s=r==null?void 0:r.data)==null?void 0:s.message),h()):c.error("Failed to delete ctmAirline.")}catch(r){console.error("Error deleting ctmAirline:",r),c.error("An error occurred while deleting the ctmAirline.")}},C=t=>{_({...o,[t.target.name]:t.target.value})},q=t=>{const a=Array.from(t.target.files);j(s=>[...s,...a]),f(s=>[...s,...a.map(r=>URL.createObjectURL(r))])},M=async t=>{var a,s,r;t.preventDefault(),N(!0);try{const i=new FormData;i.append("ctmAirline",o.ctmAirline),i.append("status",o.status),g.forEach($=>{i.append("ctmAirlineImages",$)}),console.log("formData working ",i);const n=await p.post("/api/v1/ctmFlights/create-ctmAirline",i,{headers:{"Content-Type":"multipart/form-data"}});(a=n==null?void 0:n.data)!=null&&a.success?(c.success((s=n==null?void 0:n.data)==null?void 0:s.message),u(!1),_({ctmAirline:"",status:""}),j([]),f([]),h()):c.error((r=n==null?void 0:n.data)==null?void 0:r.message)}catch(i){console.log(i),c.error("An error occurred while adding the ctmAirline.")}N(!1)},R=t=>{D(t._id),y({ctmAirline:t.ctmAirline||"",status:t.ctmAirlineStatus||""}),b(!0)},S=t=>{y({...m,[t.target.name]:t.target.value})},U=async t=>{var a,s,r;t.preventDefault(),w(!0);try{const i=await p.put(`/api/v1/ctmFlights/update-ctmAirline/${k}`,{ctmAirline:m.ctmAirline,status:m.status});(a=i==null?void 0:i.data)!=null&&a.success?(c.success(((s=i==null?void 0:i.data)==null?void 0:s.message)||"ctmAirline updated successfully"),b(!1),h()):c.error(((r=i==null?void 0:i.data)==null?void 0:r.message)||"Failed to update ctmAirline")}catch(i){console.log(i),c.error("An error occurred while updating the ctmAirline.")}w(!1)};return e.jsx(e.Fragment,{children:e.jsx(P,{children:e.jsxs("main",{class:"crm_all_body d-flex",children:[e.jsx(V,{}),e.jsx("div",{className:"crm_right relative pt-5",children:e.jsxs("section",{className:"",children:[e.jsxs("div",{className:"header_crm flex_props justify-content-between",children:[e.jsx("p",{className:"crm_title",children:"View & Add Airlines"}),e.jsxs("p",{onClick:()=>u(!0),className:"provider_btnn",children:[e.jsx("img",{src:"/imgs/add.png"}),"Add Airline"]})]}),E&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:e.jsxs("div",{className:"provider_semi_semi",children:[e.jsx("h4",{className:"add_pr_title",children:"ADD Airlines"}),e.jsx("hr",{className:"my-3"}),e.jsxs("form",{onSubmit:M,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Airline Name"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"ctmAirline",value:o.ctmAirline,onChange:C,required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Airline code"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"status",value:o.status,onChange:C,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Airline Image"}),e.jsx("input",{type:"file",multiple:!0,name:"ctmAirlineImages",className:"form-control form_in_pr",onChange:q,required:!0}),e.jsx("div",{className:"mt-2 d-flex gap-2 flex-wrap",children:A.length>0&&A.map((t,a)=>e.jsx("img",{src:t,alt:"preview",style:{width:60,height:60,objectFit:"cover",borderRadius:4,border:"1px solid #eee"}},a))}),e.jsx("div",{className:"mt-2",children:g.length>0&&g.map((t,a)=>e.jsx("div",{children:t.name},a))})]}),e.jsxs("div",{className:"flex_props gap-2 mt-3 justify-content-end",children:[e.jsx("button",{type:"submit",className:"btn_provider_pop btn_provider_pop_add",disabled:x,children:x?"Adding...":"Add"}),e.jsx("button",{type:"button",className:"btn_provider_pop",onClick:()=>{u(!1),j([]),f([])},disabled:x,children:"Cancel"})]})]})]})}),F&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:e.jsxs("div",{className:"provider_semi_semi",children:[e.jsx("h4",{className:"add_pr_title",children:"Edit Airline"}),e.jsx("hr",{className:"my-3"}),e.jsxs("form",{onSubmit:U,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Airline Name"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"ctmAirline",value:m.ctmAirline,onChange:S,required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Airline code"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"status",value:m.status,onChange:S,required:!0})]}),e.jsxs("div",{className:"flex_props gap-2 mt-3 justify-content-end",children:[e.jsx("button",{type:"submit",className:"btn_provider_pop btn_provider_pop_add",disabled:v,children:v?"Updating...":"Update"}),e.jsx("button",{type:"button",className:"btn_provider_pop",onClick:()=>b(!1),disabled:v,children:"Cancel"})]})]})]})}),e.jsx("div",{className:"bid_table mt-2",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Airlines Name"}),e.jsx("th",{children:"Airlines Code"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:d&&d.length>0?d==null?void 0:d.map((t,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"corp-img",children:e.jsx("div",{style:{display:"flex"},children:t==null?void 0:t.ctmAirlinePictures.map(s=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"productImgContainer crud-table-img",children:e.jsx("img",{src:`http://localhost:8000/uploads/${s.img}`,alt:"images",style:{width:60,height:60,objectFit:"cover",borderRadius:4,border:"1px solid #eee"}})})}))})}),e.jsx("td",{children:(t==null?void 0:t.ctmAirline)||"-"}),e.jsxs("td",{className:(t==null?void 0:t.ctmAirlineStatus)==="Active"?"text-success  text-center ":"text-warning text-center",children:[(t==null?void 0:t.ctmAirlineStatus)||"-",console.log("hererere",t)]}),e.jsx("td",{children:e.jsxs("div",{className:"action_provider_btn_main",children:[e.jsxs("button",{className:"action_provider_btn",onClick:()=>R(t),children:[e.jsx("img",{src:"/imgs/edit.png"}),"Edit"]}),e.jsxs("button",{className:"action_provider_btn action_provider_dlt",onClick:()=>L(t._id),children:[e.jsx("img",{src:"/imgs/delete-i.png"}),"Delete"]})]})})]},a)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No ctmAirline data available"})})})]})})})]})})]})})})};export{T as default};
