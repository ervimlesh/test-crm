import{h as bn,u as jn,a as Nn,r as u,p as vn,j as e,b as x,V as B}from"./index-DDoEHnfR.js";import{L as yn}from"./Layout-Co7qzEc2.js";import{S as Cn}from"./SideBar-DCoEgSRU.js";import"./moment-G82_0lEo.js";import{D as E}from"./index.es-_Aq59fjB.js";import{f as P}from"./formatUTC-BuynropG.js";import"./clsx-B-dksMZM.js";const Da=vn(),On=()=>{var me,xe,_e,he,pe,be,je,Ne,ve,ye,Ce,ke,Fe,Se,fe,we,ge,Ae,Re,Oe,Te,Ie,Be,Ee,Pe,Me,$e,Le,qe,Ue,Ve,Je,ze,Ye,He,Ze,Ge,We,Ke,Qe,Xe,De,ea,aa,na,sa,ta,ra,ca,ia,la,da,oa,ua,ma,xa,_a,ha,pa,ba,ja,Na,va;const{id:m}=bn(),{auth:i}=jn(),y=Nn(),J=u.useRef(),[a,l]=u.useState({}),[z,en]=u.useState([]),[Y,an]=u.useState([]),[q,nn]=u.useState([]),[S,sn]=u.useState([]),[f,tn]=u.useState([]),[U,H]=u.useState(""),[rn,M]=u.useState(!1),[$,Z]=u.useState(""),[cn,G]=u.useState(!1),[W,K]=u.useState(!1),[A,Q]=u.useState({outboundSegments:[],inboundSegments:[]}),[R,X]=u.useState(!1),[j,D]=u.useState(!1),[v,ee]=u.useState(!1),[h,ae]=u.useState(!1),[C,ne]=u.useState(!1),[N,L]=u.useState(!1),[w,se]=u.useState(!1),[O,te]=u.useState(!1),[T,re]=u.useState(!1),[_,ce]=u.useState(!1),[ln,ie]=u.useState(!1),dn=async()=>{(a==null?void 0:a.pnrStatus)==="approved"?y("/astrivion/authorize-preview",{state:{flightDetails:a}}):B.error("PNR status must be approved to authorize preview.")};u.useEffect(()=>{(async()=>{try{const{data:s}=await x.get(`/api/v1/flights/get-single-flight/${m}`);console.log("data is coming",s),s.success&&l(s.data)}catch(s){console.error("Error fetching flight details:",s)}})()},[m,W]),u.useEffect(()=>(Da.on("pnrStatusUpdated",n=>{n.flightId===m&&n.pnrStatus&&l(s=>({...s,pnrStatus:n.pnrStatus}))}),()=>Da.off("pnrStatusUpdated")),[m]),u.useEffect(()=>{const n=async(s,t)=>{try{const c=await x.get(`/api/v1/dropdown/get-dropdown?type=${s}`);t(c.data.items)}catch(c){console.log(c),B.error("Failed to load dropdown items")}};n("currency",nn),n("class",sn),n("cardType",tn)},[]),u.useEffect(()=>{const n=async()=>{try{const t=await x.get("/api/v1/ctmFlights/get-provider");t.data.success&&en(t.data.booking)}catch(t){console.error("Failed to fetch providers",t)}},s=async()=>{try{const t=await x.get("/api/v1/ctmFlights/get-ctmAirline");t.data.success&&an(t.data.booking)}catch(t){console.error("Failed to fetch ctmAirline",t)}};n(),s()},[]),u.useEffect(()=>{var n,s;A.outboundSegments.length===0&&A.inboundSegments.length===0&&(((n=a==null?void 0:a.outboundSegments)==null?void 0:n.length)>0||((s=a==null?void 0:a.inboundSegments)==null?void 0:s.length)>0)?Q({outboundSegments:JSON.parse(JSON.stringify(a.outboundSegments||[])),inboundSegments:JSON.parse(JSON.stringify(a.inboundSegments||[]))}):JSON.stringify(a.outboundSegments)!==JSON.stringify(A.outboundSegments)||(JSON.stringify(a.inboundSegments),JSON.stringify(A.inboundSegments))},[a,A]);const p=(n,s,t,c)=>{l(d=>{const o=[...d[`${n}Segments`]];return o[s][t]=c,{...d,[`${n}Segments`]:o}})},on=async()=>{try{await x.patch(`/api/v1/ctmFlights/update-segments/${m}`,{outboundSegments:a.outboundSegments,inboundSegments:a.inboundSegments}),alert("Itinerary segments updated!"),Q({outboundSegments:JSON.parse(JSON.stringify(a.outboundSegments)),inboundSegments:JSON.parse(JSON.stringify(a.inboundSegments))}),ce(!1)}catch(n){console.log("its error err",n),alert("Failed to update itinerary segments.")}},un=async()=>{try{await x.patch(`/api/v1/ctmFlights/update-provider/${m}`,{provider:a==null?void 0:a.provider}),alert("Provider updated successfully!")}catch(n){console.error(n),alert("Error updating provider.")}},mn=async()=>{var n,s,t,c;try{const d=J.current.value;if(!d){alert("Please select a valid bid status");return}const o=await x.patch(`/api/v1/ctmFlights/update-bid-status/${m}`,{ticketmco:d,adminAuthorize:a==null?void 0:a.adminAuthorize,bidStatus:a==null?void 0:a.bidStatus});o.data.success&&l(b=>({...b,ticketmco:d})),o&&((s=(n=o==null?void 0:o.data)==null?void 0:n.booking)!=null&&s.ticketmco)&&((c=(t=o==null?void 0:o.data)==null?void 0:t.booking)==null?void 0:c.ticketmco)==="ticketMco"&&oe(),alert("Bid status updated successfully!")}catch(d){console.error(d),alert("Error updating bid status.")}};a.createdAt&&new Date(a.createdAt).toLocaleString("en-US",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});const xn=localStorage.getItem("auth"),V=JSON.parse(xn),_n=(me=V==null?void 0:V.user)==null?void 0:me.userName;u.useEffect(()=>{l(n=>({...n,chargingBaseFare:n.chargingBaseFare||n.baseFare,chargingTaxes:n.chargingTaxes||n.taxes}))},[a==null?void 0:a.baseFare,a==null?void 0:a.taxes]);const[k,hn]=u.useState(!1),[kn,le]=u.useState(0),[de,pn]=u.useState(null),F=()=>{de&&clearTimeout(de),le(s=>{const t=s+1;return t===4?(hn(c=>!c),0):t});const n=setTimeout(()=>{le(0)},2e3);pn(n)},oe=()=>{a.transactionType==="cancellationRefund"?y("/astrivion/invoice-preview-cancellation-for-refund",{state:{flightDetails:a,isAuthFlow:!0}}):a.transactionType==="cancellationFutureCredit"?y("/astrivion/invoice-preview-cancellation-for-future-refund",{state:{flightDetails:a,isAuthFlow:!0}}):a.transactionType==="ticketIssuance"?y("/astrivion/invoice-preview-ticket-issuance",{state:{flightDetails:a,isAuthFlow:!0}}):y("/astrivion/invoice-preview",{state:{flightDetails:a,isAuthFlow:!0}})},ue={newBooking:"New Booking",exchange:"Exchange",seatAssignments:"Seat Assignments",upgrade:"Upgrade",cancellationRefund:"Cancellation for Refund",cancellationFutureCredit:"Cancellation for Future Credit",extraAddOn:"Extra Add On",ticketIssuance:"Ticket Issuance"};return e.jsxs(yn,{children:[e.jsxs("main",{class:"crm_all_body d-flex",children:[e.jsx(Cn,{}),e.jsx("div",{className:"crm_right relative",children:e.jsxs("section",{className:"",children:[e.jsx("div",{className:"header_crm flex_props justify-content-between",children:e.jsx("p",{className:"crm_title",children:"Provider Details"})}),e.jsxs("div",{className:"box_crm_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Details of Auth Form",((xe=i==null?void 0:i.user)==null?void 0:xe.role)==="superadmin"||((_e=i==null?void 0:i.user)==null?void 0:_e.role)==="admin"?e.jsxs("div",{className:"flex_props gap_2",children:[e.jsx("button",{onClick:()=>{Z("close"),M(!0)},className:"send_auth_again",children:"Close Booking"}),e.jsx("button",{onClick:()=>{Z("auth"),M(!0)},className:"send_auth_again auth_btnn",children:"Send Auth"})]}):null]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("div",{children:rn&&e.jsx("div",{className:"log_all_pop",children:e.jsxs("div",{className:"log_pop_semi",children:[e.jsxs("p",{className:"log_header flex_props justify-content-between",children:[$==="auth"?"Add Auth Remark":"Add Closeing Remark ",e.jsxs("button",{type:"button",className:"log_close",onClick:()=>M(!1),children:[" ",e.jsx("img",{src:"/imgs/close-icon.png"})]})]}),e.jsx("div",{className:"box_crm_input",children:e.jsx("textarea",{className:"form-control box_crm_input_all",placeholder:"Enter your remark here...",value:U,onChange:n=>H(n.target.value),rows:5})}),e.jsx("div",{className:"mt-3",children:e.jsx("button",{className:"auth_btn",onClick:async()=>{try{if(!U.trim()){alert("Please enter a remark before submitting.");return}const n=`[${$.toUpperCase()}] ${U}`,s={date:new Date().toISOString(),remark:n,agent:_n};$==="auth"?setTimeout(()=>{a.transactionType==="cancellationRefund"?y("/astrivion/auth-refund-invoice-preview",{state:{flightDetails:a,isAuthFlow:!0,flightId:m,newRemark:s}}):a.transactionType==="cancellationFutureCredit"?y("/astrivion/auth-future-credit-invoice-preview",{state:{flightDetails:a,isAuthFlow:!0,flightId:m,newRemark:s}}):y("/astrivion/auth-invoice-preview",{state:{flightDetails:a,isAuthFlow:!0,flightId:m,newRemark:s}})},100):$==="close"&&(await x.patch(`/api/v1/ctmFlights/update-pnrRemark-flight/${m}`,{pnrRemark:s}),alert("Close booking remark submitted!")),l(t=>({...t,pnrRemarks:[s,...(t==null?void 0:t.pnrRemarks)||[]]})),M(!1),H("")}catch(n){console.error(n),alert("Failed to update provider details.")}},children:"Submit Now"})})]})})}),cn&&e.jsx("div",{className:"log_all_pop",children:e.jsxs("div",{className:"log_pop_semi",children:[e.jsxs("p",{className:"log_header flex_props justify-content-between",children:["REMARKS",e.jsx("button",{className:"log_close",onClick:()=>G(!1),children:e.jsx("img",{src:"/imgs/close-icon.png"})})]}),e.jsxs("div",{className:"bid_table",children:[((he=a==null?void 0:a.pnrRemarks)==null?void 0:he.some(n=>n.remark.startsWith("[AUTH]")))&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"remarks_semi_title remarks_semi_title_minuss",children:"Authentication Remarks"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"DATE"}),e.jsx("th",{children:"REMARK"}),e.jsx("th",{children:"AGENT"})]})}),e.jsx("tbody",{children:a.pnrRemarks.filter(n=>n.remark.startsWith("[AUTH]")).map((n,s)=>{var t;return e.jsxs("tr",{children:[e.jsx("td",{children:n.date?e.jsx("p",{children:P(n.date)}):e.jsx("p",{children:"Loading date..."})}),e.jsx("td",{children:(t=n.remark)==null?void 0:t.replace("[AUTH]","").trim()}),e.jsx("td",{children:n.agent})]},`auth-${s}`)})})]})})]}),((pe=a==null?void 0:a.pnrRemarks)==null?void 0:pe.some(n=>n.remark.startsWith("[CLOSE]")))&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"remarks_semi_title mt-3",children:"Closed Booking Remarks"}),e.jsx("div",{className:"bid_table",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"DATE"}),e.jsx("th",{children:"REMARK"}),e.jsx("th",{children:"AGENT"})]})}),e.jsx("tbody",{children:a.pnrRemarks.filter(n=>n.remark.startsWith("[CLOSE]")).map((n,s)=>{var t;return e.jsxs("tr",{children:[e.jsx("td",{children:n.date?e.jsx("p",{children:P(n.date)}):e.jsx("p",{children:"Loading date..."})}),e.jsx("td",{children:(t=n.remark)==null?void 0:t.replace("[CLOSE]","").trim()}),e.jsx("td",{children:n.agent})]},`close-${s}`)})})]})})})]})]})]})}),W&&e.jsx("div",{className:"log_all_pop",children:e.jsxs("div",{className:"log_pop_semi",children:[e.jsxs("p",{className:"log_header flex_props justify-content-between",children:["Activity Log",e.jsx("button",{className:"log_close",onClick:()=>K(!1),children:e.jsx("img",{src:"/imgs/close-icon.png"})})]}),e.jsxs("div",{className:"created_bg_c",children:[e.jsxs("p",{children:["Created By : ",(be=a==null?void 0:a.agent)==null?void 0:be.userName," "]}),e.jsxs("div",{className:"flex_props gap-2",children:["Date :"," ",a!=null&&a.createdAt?e.jsx("p",{children:P(a.createdAt)}):e.jsx("p",{children:"Loading date..."})]})]}),e.jsx("div",{className:"bid_table",children:(a==null?void 0:a.logActivity.length)===0?e.jsx("p",{children:"No activity yet."}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Details"}),e.jsx("th",{children:"Date & Time"}),e.jsx("th",{children:"Edit by "})]})}),e.jsx("tbody",{children:(Ne=(je=a==null?void 0:a.logActivity)==null?void 0:je.slice().sort((n,s)=>new Date(s.updatedAt)-new Date(n.updatedAt)))==null?void 0:Ne.map((n,s)=>{var t,c,d,o,b,I,ya,Ca,ka,Fa,Sa,fa,wa,ga,Aa,Ra,Oa,Ta,Ia,Ba,Ea,Pa,Ma,$a,La,qa,Ua,Va,Ja,za,Ya,Ha,Za,Ga,Wa,Ka,Qa,Xa;return e.jsxs("tr",{children:[e.jsx("td",{children:n.type}),e.jsxs("td",{children:[n.type==="segment-update"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{class:"title_common_semi_main1 title_common_semi_main_activity",children:e.jsx("span",{children:"Outbound Segment:"})}),(c=(t=n==null?void 0:n.data)==null?void 0:t.outboundSegments)==null?void 0:c.map((r,g)=>e.jsxs("div",{children:[(r==null?void 0:r.airline)&&e.jsxs(e.Fragment,{children:["Airline: ",r.airline,","," "]}),(r==null?void 0:r.flight)&&e.jsxs(e.Fragment,{children:["Flight: ",r.flight,", "]}),(r==null?void 0:r.from)&&e.jsxs(e.Fragment,{children:["From: ",r.from,", "]}),(r==null?void 0:r.to)&&e.jsxs(e.Fragment,{children:["To: ",r.to,", "]}),(r==null?void 0:r.departure)&&e.jsxs(e.Fragment,{children:["Departure:"," ",new Date(r.departure).toLocaleString(),","," "]}),(r==null?void 0:r.arrival)&&e.jsxs(e.Fragment,{children:["Arrival:"," ",new Date(r.arrival).toLocaleString(),","," "]}),(r==null?void 0:r.class)&&e.jsxs(e.Fragment,{children:["Class: ",r.class,", "]}),(r==null?void 0:r.alLocator)&&e.jsxs(e.Fragment,{children:["Locator: ",r.alLocator]})]},g)),(o=(d=n==null?void 0:n.data)==null?void 0:d.inboundSegments)==null?void 0:o.map((r,g)=>e.jsxs(e.Fragment,{children:[e.jsx("div",{class:"title_common_semi_main1 title_common_semi_main_activity",children:e.jsx("span",{children:"Inbound Segment:"})}),e.jsxs("div",{children:[(r==null?void 0:r.airline)&&e.jsxs(e.Fragment,{children:["Airline: ",r.airline,","," "]}),(r==null?void 0:r.flight)&&e.jsxs(e.Fragment,{children:["Flight: ",r.flight,","," "]}),(r==null?void 0:r.from)&&e.jsxs(e.Fragment,{children:["From: ",r.from,", "]}),(r==null?void 0:r.to)&&e.jsxs(e.Fragment,{children:["To: ",r.to,", "]}),(r==null?void 0:r.departure)&&e.jsxs(e.Fragment,{children:["Departure:"," ",new Date(r.departure).toLocaleString(),","," "]}),(r==null?void 0:r.arrival)&&e.jsxs(e.Fragment,{children:["Arrival:"," ",new Date(r.arrival).toLocaleString(),","," "]}),(r==null?void 0:r.class)&&e.jsxs(e.Fragment,{children:["Class: ",r.class,", "]}),(r==null?void 0:r.alLocator)&&e.jsxs(e.Fragment,{children:["Locator: ",r.alLocator]})]},g)]}))]}),n.type==="price-update"&&e.jsxs(e.Fragment,{children:[((b=n==null?void 0:n.data)==null?void 0:b.baseFare)&&e.jsxs(e.Fragment,{children:["Base Fare: ",n.data.baseFare,","," "]}),((I=n==null?void 0:n.data)==null?void 0:I.taxes)&&e.jsxs(e.Fragment,{children:["Taxes: ",n.data.taxes,", "]}),((ya=n==null?void 0:n.data)==null?void 0:ya.currency)&&e.jsxs(e.Fragment,{children:["Currency: ",n.data.currency," "]})]}),n.type==="chargeback-update"&&e.jsxs(e.Fragment,{children:[((Ca=n==null?void 0:n.data)==null?void 0:Ca.chargeAmount)&&e.jsxs(e.Fragment,{children:["Charge Amount:"," ",n.data.chargeAmount,","," "]}),((ka=n==null?void 0:n.data)==null?void 0:ka.chargebackDate)&&e.jsxs(e.Fragment,{children:["Chargeback Date:"," ",n.data.chargebackDate,","," "]}),((Fa=n==null?void 0:n.data)==null?void 0:Fa.reasonForChargeback)&&e.jsxs(e.Fragment,{children:["Reason:"," ",n.data.reasonForChargeback,","," "]}),((Sa=n==null?void 0:n.data)==null?void 0:Sa.chargebackStatus)&&e.jsxs(e.Fragment,{children:["Status:"," ",n.data.chargebackStatus]})]}),n.type==="refund-update"&&e.jsxs(e.Fragment,{children:[((fa=n==null?void 0:n.data)==null?void 0:fa.amount)&&e.jsxs(e.Fragment,{children:["Refund Amount: ",n.data.amount,","," "]}),((wa=n==null?void 0:n.data)==null?void 0:wa.refundRequestedOn)&&e.jsxs(e.Fragment,{children:["Requested On:"," ",n.data.refundRequestedOn,","," "]}),((ga=n==null?void 0:n.data)==null?void 0:ga.reasonForRefund)&&e.jsxs(e.Fragment,{children:["Reason:"," ",n.data.reasonForRefund,","," "]}),((Aa=n==null?void 0:n.data)==null?void 0:Aa.refundStatus)&&e.jsxs(e.Fragment,{children:["Status: ",n.data.refundStatus]})]}),n.type==="billing-update"&&e.jsxs(e.Fragment,{children:[((Ra=n==null?void 0:n.data)==null?void 0:Ra.cardType)&&e.jsxs(e.Fragment,{children:["Card Type: ",n.data.cardType,","," "]}),((Oa=n==null?void 0:n.data)==null?void 0:Oa.cchName)&&e.jsxs(e.Fragment,{children:["Card Holder: ",n.data.cchName,","," "]}),((Ta=n==null?void 0:n.data)==null?void 0:Ta.email)&&e.jsxs(e.Fragment,{children:["Email: ",n.data.email,", "]}),(((Ia=n==null?void 0:n.data)==null?void 0:Ia.billingAddress1)||((Ba=n==null?void 0:n.data)==null?void 0:Ba.billingAddress2))&&e.jsxs(e.Fragment,{children:["Billing Address:"," ",n.data.billingAddress1||"",n.data.billingAddress2?`, ${n.data.billingAddress2}`:"",","," "]}),((Ea=n==null?void 0:n.data)==null?void 0:Ea.city)&&e.jsxs(e.Fragment,{children:["City: ",n.data.city,", "]}),((Pa=n==null?void 0:n.data)==null?void 0:Pa.state)&&e.jsxs(e.Fragment,{children:["State: ",n.data.state,", "]}),((Ma=n==null?void 0:n.data)==null?void 0:Ma.country)&&e.jsxs(e.Fragment,{children:["Country: ",n.data.country,", "]}),(($a=n==null?void 0:n.data)==null?void 0:$a.zipCode)&&e.jsxs(e.Fragment,{children:["ZipCode: ",n.data.zipCode]})]}),n.type==="provider-update"&&e.jsxs(e.Fragment,{children:[((La=n==null?void 0:n.data)==null?void 0:La.provider)&&e.jsxs(e.Fragment,{children:["Provider: ",n.data.provider,","," "]}),((qa=n==null?void 0:n.data)==null?void 0:qa.pnrStatus)&&e.jsxs(e.Fragment,{children:["PNR Status: ",n.data.pnrStatus]})]}),n.type==="charging-update"&&e.jsxs(e.Fragment,{children:[((Ua=n==null?void 0:n.data)==null?void 0:Ua.chargingBaseFare)&&e.jsxs(e.Fragment,{children:["Base Fare:"," ",n.data.chargingBaseFare,","," "]}),((Va=n==null?void 0:n.data)==null?void 0:Va.chargingTaxes)&&e.jsxs(e.Fragment,{children:["Charging Taxes:"," ",n.data.chargingTaxes,","," "]}),((Ja=n==null?void 0:n.data)==null?void 0:Ja.chargingStatus)&&e.jsxs(e.Fragment,{children:["Status:"," ",n.data.chargingStatus,","," "]}),((za=n==null?void 0:n.data)==null?void 0:za.chargedOn)&&e.jsxs(e.Fragment,{children:["Charged On: ",n.data.chargedOn,","," "]}),((Ya=n==null?void 0:n.data)==null?void 0:Ya.chargedBy)&&e.jsxs(e.Fragment,{children:["Charged By: ",n.data.chargedBy]})]}),n.type==="passenger-update"&&Array.isArray(n.data)&&e.jsx(e.Fragment,{children:n.data.map((r,g)=>e.jsxs("div",{className:"passenger_activity",children:["Passenger ",g+1,":"," ",(r==null?void 0:r.detailsType)&&e.jsxs(e.Fragment,{children:["Type:"," ",r.detailsType,","," "]}),((r==null?void 0:r.firstName)||(r==null?void 0:r.middleName)||(r==null?void 0:r.lastName))&&e.jsxs(e.Fragment,{children:["Name:"," ",r.firstName||""," ",r.middleName||""," ",r.lastName||"",","," "]}),(r==null?void 0:r.gender)&&e.jsxs(e.Fragment,{children:["Gender:"," ",r.gender,","," "]}),(r==null?void 0:r.dob)&&e.jsxs(e.Fragment,{children:["DOB: ",r.dob,","," "]}),e.jsxs(e.Fragment,{children:["Ticket Number:"," ",r.ticketNumber||"N/A"]})]},r._id||g))}),n.type==="bid-status-update"&&e.jsxs(e.Fragment,{children:[((Ha=n==null?void 0:n.data)==null?void 0:Ha.ticketmco)&&e.jsxs(e.Fragment,{children:["MCO: ",n.data.ticketmco,", "]}),((Za=n==null?void 0:n.data)==null?void 0:Za.bidStatus)&&e.jsxs(e.Fragment,{children:["Status: ",n.data.bidStatus]})]}),n.type==="send-mail-update"&&e.jsxs(e.Fragment,{children:[((Ga=n==null?void 0:n.data)==null?void 0:Ga.language)&&e.jsxs(e.Fragment,{children:["Language: ",n.data.language,","," "]}),((Wa=n==null?void 0:n.data)==null?void 0:Wa.transactionType)&&e.jsxs(e.Fragment,{children:["Requested On:"," ",n.data.transactionType,","," "]}),((Ka=n==null?void 0:n.data)==null?void 0:Ka.agentFigure)&&e.jsxs(e.Fragment,{children:["Reason: ",n.data.agentFigure,","," "]}),((Qa=n==null?void 0:n.data)==null?void 0:Qa.refundStatus)&&e.jsxs(e.Fragment,{children:["Status: ",n.data.refundStatus]})]})]}),e.jsx("td",{children:n!=null&&n.updatedAt?e.jsx("p",{children:P(n.updatedAt)}):e.jsx("p",{children:"Loading date..."})}),e.jsxs("td",{className:"edit_flex_b_p",children:[n==null?void 0:n.logName,e.jsxs("span",{className:"profile_box",children:[" ",n==null?void 0:n.logRole]})]})]},((Xa=n._id)==null?void 0:Xa.$oid)||s)})})]})})})]})})]}),e.jsx("div",{className:"table_responsive mt-3",children:e.jsx("div",{className:"table_custom row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"",children:[e.jsxs("ul",{className:"table_custom_header1",children:[e.jsx("li",{children:"BID"}),e.jsx("li",{children:a.bookingId||"N/A"})]}),e.jsxs("ul",{className:"table_custom_header1",children:[e.jsx("li",{children:"Provider"}),e.jsx("li",{children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-8 pe-2",children:e.jsxs("select",{id:"providerSelect",className:"form-select",value:((ve=a.provider)==null?void 0:ve._id)||"",onChange:n=>{const s=z.find(t=>t._id===n.target.value);l(t=>({...t,provider:s}))},required:!0,children:[e.jsx("option",{value:"",children:"Select"}),z.filter(n=>n.providerStatus==="Active").map(n=>e.jsx("option",{value:n._id,children:n.provider},n._id))]})}),e.jsx("div",{className:"col-4 ps-2",children:e.jsx("button",{className:"submit_btn_provider",onClick:async n=>{if(n.preventDefault(),!(a!=null&&a.provider)){alert("Please select a provider!");return}await un()},children:"Submit Provider"})})]})})]}),(a==null?void 0:a.transactionType)&&ue[a.transactionType]&&e.jsxs("ul",{className:"table_custom_header1",children:[e.jsx("li",{children:"Transaction Type"}),e.jsx("li",{className:"text_cap",children:e.jsx("div",{className:"text_cap_highlight",children:ue[a.transactionType]})})]}),e.jsxs("ul",{className:"table_custom_header1",children:[e.jsx("li",{children:"Date & Time Created"}),e.jsx("li",{children:a!=null&&a.createdAt?e.jsx("p",{children:P(a.createdAt)}):e.jsx("p",{children:"Loading date..."})})]}),e.jsxs("ul",{className:"table_custom_header1",children:[e.jsx("li",{children:"Auth Status"}),e.jsx("li",{children:e.jsxs("td",{className:`text-$${a.pnrStatus==="approved"?"success":"warning"}`,children:[(Ce=(ye=a.pnrStatus)==null?void 0:ye.replace(/([A-Z])/g," $1"))==null?void 0:Ce.replace(/^\\w/,n=>n.toUpperCase()),a.pnrStatus==="approved"&&e.jsx("button",{className:"auth_btn_preview",onClick:dn,children:"Auth Preview"})]})})]}),e.jsxs("ul",{className:"table_custom_header1",children:[e.jsx("li",{children:"EDIT BID Status"}),e.jsx("li",{children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-4",children:a!=null&&a.ticketmco?a.ticketmco.toLowerCase()==="ticketmco"?e.jsx("p",{children:"Ticketed & MCO Charged"}):e.jsx("p",{children:a.ticketmco.replace(/([A-Z])/g," $1").replace(/^\w/,n=>n.toUpperCase())}):e.jsx("p",{children:"Pending"})}),e.jsx("div",{className:"col-6 pe-2",children:e.jsxs("select",{id:"ticketmco",className:"form-select",defaultValue:(a==null?void 0:a.ticketmco)||"",ref:J,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"underFollowUp",children:"Under Follow up"}),(a==null?void 0:a.chargingStatus)==="charged"&&Array.isArray(a==null?void 0:a.passengerDetails)&&a.passengerDetails.length>0&&a.passengerDetails.every(n=>(n.ticketNumber??"").trim()!=="")&&e.jsx("option",{value:"ticketMco",children:"Ticketed & MCO Charged"})]})}),e.jsx("div",{className:"col-2 ps-2",children:e.jsx("button",{className:"submit_btn_provider",onClick:n=>{if(n.preventDefault(),!(a!=null&&a.ticketmco)){alert("Please filled a valid Bid status");return}mn()},children:"Submit"})})]})})]})]})})})})]}),e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Itinerary Details",((ke=i==null?void 0:i.user)==null?void 0:ke.role)==="superadmin"||((Fe=i==null?void 0:i.user)==null?void 0:Fe.role)==="admin"?e.jsx("div",{className:"flex_props gap-2",children:_?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:on,children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>ce(!0),children:"Edit"})}):null]}),e.jsxs("div",{className:_?"":"op_reduce",children:[((Se=a==null?void 0:a.outboundSegments)==null?void 0:Se.length)>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"title_common_semi_main1",children:e.jsx("span",{children:"Outbound Segments"})}),a.outboundSegments.map((n,s)=>e.jsxs("div",{className:`outbound_segment_container outbound_segment_container${s}`,children:[e.jsxs("p",{className:"title_common_semi1",children:["Outbound Flight ",s+1]}),e.jsxs("div",{className:"mt-2 flex_all form_box_auth",children:[e.jsx("div",{className:"width_control_in13 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Airlines"}),e.jsxs("select",{name:"airline",className:"form-select box_crm_input_all",disabled:!_,value:n.airline,onChange:t=>p("outbound",s,"airline",t.target.value),children:[e.jsx("option",{value:"",children:"select"}),Y.map(t=>e.jsx("option",{value:t.ctmAirline,children:t.ctmAirline},t._id))]})]})}),e.jsx("div",{className:"width_control_in13 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Flight Number"}),e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!_,value:n.flight,onChange:t=>p("outbound",s,"flight",t.target.value)})]})}),e.jsx("div",{className:"width_control_in37 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Destination From"}),e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!_,value:n.from,onChange:t=>p("outbound",s,"from",t.target.value)})]})}),e.jsx("div",{className:"width_control_in37 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Destination To"}),e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!_,value:n.to,onChange:t=>p("outbound",s,"to",t.target.value)})]})}),e.jsx("div",{className:"width_control_in23 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Departure Date"}),e.jsx("input",{type:"datetime-local",className:"form-control box_crm_input_all",readOnly:!_,value:new Date(n.departure).toISOString().slice(0,16),onChange:t=>p("outbound",s,"departure",t.target.value)})]})}),e.jsx("div",{className:"width_control_in23 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Arrival Date"}),e.jsx("input",{type:"datetime-local",className:"form-control box_crm_input_all",readOnly:!_,value:new Date(n.arrival).toISOString().slice(0,16),onChange:t=>p("outbound",s,"arrival",t.target.value)})]})}),e.jsx("div",{className:"width_control_in23 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Class"}),e.jsxs("select",{className:"form-control box_crm_input_all",disabled:!_,value:n.class,onChange:t=>p("outbound",s,"class",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),S==null?void 0:S.map((t,c)=>e.jsx("option",{value:t.value,children:t.label},c))]})]})}),e.jsx("div",{className:"width_control_in23 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Al Locator"}),e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!_,value:n.alLocator,onChange:t=>p("outbound",s,"alLocator",t.target.value)})]})})]},`outbound-${s}`)]}))]}),((fe=a==null?void 0:a.inboundSegments)==null?void 0:fe.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"title_common_semi_main1 mt-3",children:e.jsx("span",{children:"Inbound Segments"})}),a.inboundSegments.map((n,s)=>e.jsxs("div",{className:`outbound_segment_container outbound_segment_container${s}`,children:[e.jsxs("p",{className:"title_common_semi1",children:["Inbound Flight ",s+1]}),e.jsxs("div",{className:"mt-2 flex_all form_box_auth",children:[e.jsx("div",{className:"width_control_in13 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Airlines"}),e.jsxs("select",{name:"airline",className:"form-select box_crm_input_all",disabled:!_,value:n.airline,onChange:t=>p("inbound",s,"airline",t.target.value),children:[e.jsx("option",{value:"",children:"select"}),Y.map(t=>e.jsx("option",{value:t.ctmAirline,children:t.ctmAirline},t._id))]})]})}),e.jsx("div",{className:"width_control_in13 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Flight Number"}),e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!_,value:n.flight,onChange:t=>p("inbound",s,"flight",t.target.value)})]})}),e.jsx("div",{className:"width_control_in37 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Destination From"}),e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!_,value:n.from,onChange:t=>p("inbound",s,"from",t.target.value)})]})}),e.jsx("div",{className:"width_control_in37 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Destination To"}),e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!_,value:n.to,onChange:t=>p("inbound",s,"to",t.target.value)})]})}),e.jsx("div",{className:"width_control_in23 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Departure Date"}),e.jsx("input",{type:"datetime-local",className:"form-control box_crm_input_all",readOnly:!_,value:new Date(n.departure).toISOString().slice(0,16),onChange:t=>p("inbound",s,"departure",t.target.value)})]})}),e.jsx("div",{className:"width_control_in23 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Arrival Date"}),e.jsx("input",{type:"datetime-local",className:"form-control box_crm_input_all",readOnly:!_,value:new Date(n.arrival).toISOString().slice(0,16),onChange:t=>p("inbound",s,"arrival",t.target.value)})]})}),e.jsx("div",{className:"width_control_in23 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Class"}),e.jsxs("select",{className:"form-control box_crm_input_all",disabled:!_,value:n.class,onChange:t=>p("inbound",s,"class",t.target.value),children:[e.jsx("option",{value:"",children:"Select"}),S==null?void 0:S.map((t,c)=>e.jsx("option",{value:t.value,children:t.label},c))]})]})}),e.jsx("div",{className:"width_control_in23 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Al Locator"}),e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!_,value:n.alLocator,onChange:t=>p("inbound",s,"alLocator",t.target.value)})]})})]},`inbound-${s}`)]}))]})]})]}),(a==null?void 0:a.transactionType)&&(a==null?void 0:a.transactionType)==="cancellationRefund"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Ticket Refund Details",((we=i==null?void 0:i.user)==null?void 0:we.role)==="superadmin"||((ge=i==null?void 0:i.user)==null?void 0:ge.role)==="admin"?e.jsx("div",{className:"flex_props gap-2",children:N?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:async()=>{var n,s,t,c;try{const d={cancelRefAmount:((n=a==null?void 0:a.cancellationRefund)==null?void 0:n.cancelRefAmount)||void 0,cancelRefRequestOn:((s=a==null?void 0:a.cancellationRefund)==null?void 0:s.cancelRefRequestOn)||void 0,cancelRefReason:((t=a==null?void 0:a.cancellationRefund)==null?void 0:t.cancelRefReason)||void 0,cancelRefStatus:((c=a==null?void 0:a.cancellationRefund)==null?void 0:c.cancelRefStatus)||void 0};await x.patch(`/api/v1/ctmFlights/update-cancellation-refund-details/${m}`,d),alert("Refund details updated!"),L(!1);const{data:o}=await x.get(`/api/v1/flights/get-single-flight/${m}`);o.success&&l(o.data)}catch(d){console.error(d),alert("Failed to update refund details.")}},children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>L(!0),children:"Edit"})}):null]}),e.jsxs("div",{className:"mt-2 flex_all form_box_auth",children:[e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Amount"}),e.jsx("input",{type:"text",value:((Ae=a==null?void 0:a.cancellationRefund)==null?void 0:Ae.cancelRefAmount)||"",className:"form-control box_crm_input_all",readOnly:!N,onChange:n=>{l(s=>({...s,cancellationRefund:{...(s==null?void 0:s.cancellationRefund)||{},cancelRefAmount:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Refund Requested On"}),e.jsx(E,{selected:(Re=a==null?void 0:a.cancellationRefund)!=null&&Re.cancelRefRequestOn?new Date(a.cancellationRefund.cancelRefRequestOn):null,onChange:n=>{l(s=>({...s,cancellationRefund:{...(s==null?void 0:s.cancellationRefund)||{},cancelRefRequestOn:n?n.toISOString().split("T")[0]:""}}))},className:"form-control box_crm_input_all",dateFormat:"yyyy-MM-dd",disabled:!N})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Reason for Refund"}),e.jsx("input",{type:"text",value:((Oe=a==null?void 0:a.cancellationRefund)==null?void 0:Oe.cancelRefReason)||"",className:"form-control box_crm_input_all",readOnly:!N,onChange:n=>{l(s=>({...s,cancellationRefund:{...(s==null?void 0:s.cancellationRefund)||{},cancelRefReason:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp"})]})]})}),(a==null?void 0:a.transactionType)&&(a==null?void 0:a.transactionType)==="cancellationFutureCredit"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Future Credit Details",((Te=i==null?void 0:i.user)==null?void 0:Te.role)==="superadmin"||((Ie=i==null?void 0:i.user)==null?void 0:Ie.role)==="admin"?e.jsx("div",{className:"flex_props gap-2",children:O?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:async()=>{var n,s,t,c;try{const d={futureCreditAmount:((n=a==null?void 0:a.futureCredit)==null?void 0:n.futureCreditAmount)||void 0,futureCreditRequestedOn:((s=a==null?void 0:a.futureCredit)==null?void 0:s.futureCreditRequestedOn)||void 0,futureCreditValidity:((t=a==null?void 0:a.futureCredit)==null?void 0:t.futureCreditValidity)||void 0,reasonForFutureCredit:((c=a==null?void 0:a.futureCredit)==null?void 0:c.reasonForFutureCredit)||void 0};await x.patch(`/api/v1/ctmFlights/update-futureCredit-details/${m}`,d),alert("Future credit details updated!"),te(!1);const{data:o}=await x.get(`/api/v1/flights/get-single-flight/${m}`);o.success&&l(o.data)}catch(d){console.error(d),alert("Failed to update future credit details.")}},children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>te(!0),children:"Edit"})}):null]}),e.jsxs("div",{className:"mt-2 flex_all form_box_auth",children:[e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Amount"}),e.jsx("input",{type:"text",value:((Be=a==null?void 0:a.futureCredit)==null?void 0:Be.futureCreditAmount)||"",className:"form-control box_crm_input_all",readOnly:!O,onChange:n=>{l(s=>({...s,futureCredit:{...(s==null?void 0:s.futureCredit)||{},futureCreditAmount:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Requested On"}),e.jsx(E,{selected:(Ee=a==null?void 0:a.futureCredit)!=null&&Ee.futureCreditRequestedOn?new Date(a.futureCredit.futureCreditRequestedOn):null,onChange:n=>{l(s=>({...s,futureCredit:{...(s==null?void 0:s.futureCredit)||{},futureCreditRequestedOn:n?n.toISOString().split("T")[0]:""}}))},className:"form-control box_crm_input_all",dateFormat:"yyyy-MM-dd",disabled:!O})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Validity"}),e.jsx(E,{selected:(Pe=a==null?void 0:a.futureCredit)!=null&&Pe.futureCreditValidity?new Date(a.futureCredit.futureCreditValidity):null,onChange:n=>{l(s=>({...s,futureCredit:{...(s==null?void 0:s.futureCredit)||{},futureCreditValidity:n?n.toISOString().split("T")[0]:""}}))},className:"form-control box_crm_input_all",dateFormat:"yyyy-MM-dd",disabled:!O})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Reason"}),e.jsx("input",{type:"text",value:((Me=a==null?void 0:a.futureCredit)==null?void 0:Me.reasonForFutureCredit)||"",className:"form-control box_crm_input_all",readOnly:!O,onChange:n=>{l(s=>({...s,futureCredit:{...(s==null?void 0:s.futureCredit)||{},reasonForFutureCredit:n.target.value}}))}})]})})]})]})}),(a==null?void 0:a.transactionType)&&(a==null?void 0:a.transactionType)==="ticketIssuance"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Ticket Issue Details",(($e=i==null?void 0:i.user)==null?void 0:$e.role)==="superadmin"||((Le=i==null?void 0:i.user)==null?void 0:Le.role)==="admin"?e.jsx("div",{className:"flex_props gap-2",children:T?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:async()=>{var n,s,t,c;try{const d={ticketIssueAmount:((n=a==null?void 0:a.ticketIssueDetails)==null?void 0:n.ticketIssueAmount)||void 0,ticketIssueRequestedOn:((s=a==null?void 0:a.ticketIssueDetails)==null?void 0:s.ticketIssueRequestedOn)||void 0,ticketIssueValidity:((t=a==null?void 0:a.ticketIssueDetails)==null?void 0:t.ticketIssueValidity)||void 0,ticketIssueReason:((c=a==null?void 0:a.ticketIssueDetails)==null?void 0:c.ticketIssueReason)||void 0};await x.patch(`/api/v1/ctmFlights/update-ticketIssue-details/${m}`,d),alert("Tiecket issuence details updated successfully"),re(!1);const{data:o}=await x.get(`/api/v1/flights/get-single-flight/${m}`);o.success&&l(o.data)}catch(d){console.error(d),alert("Failed to update future credit details.")}},children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>re(!0),children:"Edit"})}):null]}),e.jsxs("div",{className:"mt-2 flex_all form_box_auth",children:[e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Amount"}),e.jsx("input",{type:"text",value:((qe=a==null?void 0:a.ticketIssueDetails)==null?void 0:qe.ticketIssueAmount)||"",className:"form-control box_crm_input_all",disabled:!T,onChange:n=>{l(s=>({...s,ticketIssueDetails:{...(s==null?void 0:s.ticketIssueDetails)||{},ticketIssueAmount:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Requested On"}),e.jsx(E,{selected:(Ue=a==null?void 0:a.ticketIssueDetails)!=null&&Ue.ticketIssueRequestedOn?new Date(a.ticketIssueDetails.ticketIssueRequestedOn):null,onChange:n=>{l(s=>({...s,ticketIssueDetails:{...(s==null?void 0:s.ticketIssueDetails)||{},ticketIssueRequestedOn:n?n.toISOString().split("T")[0]:""}}))},className:"form-control box_crm_input_all",dateFormat:"yyyy-MM-dd",disabled:!T})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Validity"}),e.jsx(E,{selected:(Ve=a==null?void 0:a.ticketIssueDetails)!=null&&Ve.ticketIssueValidity?new Date(a.ticketIssueDetails.ticketIssueValidity):null,onChange:n=>{l(s=>({...s,ticketIssueDetails:{...(s==null?void 0:s.ticketIssueDetails)||{},ticketIssueValidity:n?n.toISOString().split("T")[0]:""}}))},className:"form-control box_crm_input_all",dateFormat:"yyyy-MM-dd",disabled:!T})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Reason"}),e.jsx("input",{type:"text",value:((Je=a==null?void 0:a.ticketIssueDetails)==null?void 0:Je.ticketIssueReason)||"",className:"form-control box_crm_input_all",readOnly:!T,onChange:n=>{l(s=>({...s,ticketIssueDetails:{...(s==null?void 0:s.ticketIssueDetails)||{},ticketIssueReason:n.target.value}}))}})]})})]})]})}),e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Price Details",((ze=i==null?void 0:i.user)==null?void 0:ze.role)==="superadmin"||((Ye=i==null?void 0:i.user)==null?void 0:Ye.role)==="admin"?e.jsx("div",{class:"flex_props gap-2",children:R?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:async()=>{try{await x.patch(`/api/v1/ctmFlights/update-price-details/${m}`,{baseFare:a.baseFare,taxes:a.taxes,totalAmount:Number(a.baseFare||0)+Number(a.taxes||0),currency:a.currency}),alert("Price details updated!"),X(!1)}catch{alert("Failed to update price details.")}},children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>{X(!0)},children:"Edit"})}):null]}),e.jsxs("div",{className:R?"mt-2 flex_all form_box_auth":"mt-2 flex_all form_box_auth op_reduce",children:[e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Base Fare"}),e.jsx("input",{type:"number",className:"form-control box_crm_input_all",value:(a==null?void 0:a.baseFare)||"",readOnly:!R,onChange:n=>{const s=n.target.value,t=(a==null?void 0:a.taxes)||0;l(c=>({...c,baseFare:s,totalAmount:Number(s||0)+Number(t)}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Tax & Fees"}),e.jsx("input",{type:"number",className:"form-control box_crm_input_all",value:(a==null?void 0:a.taxes)||"",readOnly:!R,onChange:n=>{const s=n.target.value,t=(a==null?void 0:a.baseFare)||0;l(c=>({...c,taxes:s,totalAmount:Number(t)+Number(s||0)}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Total Amount"}),e.jsx("input",{type:"text",className:"form-control box_crm_input_all",value:isNaN(Number(a==null?void 0:a.baseFare)+Number(a==null?void 0:a.taxes))?"":(()=>{var b,I;const n=((b=a==null?void 0:a.baseFare)==null?void 0:b.toString())||"0",s=((I=a==null?void 0:a.taxes)==null?void 0:I.toString())||"0",t=parseFloat(n)+parseFloat(s),c=(n.split(".")[1]||"").length,d=(s.split(".")[1]||"").length,o=Math.max(c,d);return t.toFixed(o)})(),readOnly:!0})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{htmlFor:"",children:"Currency"}),e.jsx("select",{className:"form-control box_crm_input_all",value:(a==null?void 0:a.currency)||"",disabled:!R,onChange:n=>{l(s=>({...s,currency:n.target.value}))},children:q==null?void 0:q.map((n,s)=>e.jsx("option",{value:n.value,children:n.label},s))})]})})]})]}),e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Charging Details",((He=i==null?void 0:i.user)==null?void 0:He.role)==="superadmin"||((Ze=i==null?void 0:i.user)==null?void 0:Ze.role)==="admin"?e.jsx("div",{className:"flex_props gap-2",children:j?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:async()=>{try{const n={baseFare:"Base Fare",chargingStatus:"Charging Status",chargedOn:"Charged On",chargedBy:"Charged By",taxes:"Charging Tax",chargingTaxStatus:"Charging Tax Status",chargingTaxchargedOn:"Charging Tax Charged On",chargingTaxchargedBy:"Charging Tax Charged By"};for(const t in n)if(!(a!=null&&a[t])){B.error(`${n[t]} is required`);return}const s=await x.patch(`/api/v1/ctmFlights/update-charging-details/${m}`,{chargingBaseFare:a.baseFare,chargingStatus:a.chargingStatus,chargedOn:a.chargedOn,chargedBy:a.chargedBy,chargingTaxes:a.taxes,chargingTaxStatus:a.chargingTaxStatus,chargingTaxchargedOn:a.chargingTaxchargedOn,chargingTaxchargedBy:a.chargingTaxchargedBy});D(!1)}catch{alert("Failed to update charging details.")}},children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>{D(!0)},children:"Edit"})}):null]}),e.jsx("div",{className:j?"provide_table mt-3":"provide_table mt-3 op_reduce",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{children:[e.jsxs("thead",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Charged On"}),e.jsx("th",{children:"Charged By"})]}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Base Fare"}),e.jsx("td",{children:e.jsx("div",{className:"input_charging_de box_crm_input",children:e.jsx("input",{type:"number",className:"form-control box_crm_input_all",value:(a==null?void 0:a.baseFare)||"",readOnly:!j,onChange:n=>{const s=n.target.value,t=(a==null?void 0:a.taxes)||0;l(c=>({...c,baseFare:s,totalAmount:Number(s||0)+Number(t)}))}})})}),e.jsx("td",{children:e.jsx("div",{className:"box_crm_input",children:e.jsxs("select",{className:"form-select box_crm_input_all",disabled:!j,value:(a==null?void 0:a.chargingStatus)||"",onChange:n=>l(s=>({...s,chargingStatus:n.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"declined",children:"Declined"}),e.jsx("option",{value:"charged",children:"Charged"}),e.jsx("option",{value:"pending",children:"Pending"})]})})}),e.jsx("td",{children:e.jsx("div",{className:"input_charging_de box_crm_input",children:e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!j,value:(a==null?void 0:a.chargedOn)||"",onChange:n=>l(s=>({...s,chargedOn:n.target.value}))})})}),e.jsx("td",{children:e.jsx("div",{className:"input_charging_de box_crm_input",children:e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!j,value:(a==null?void 0:a.chargedBy)||"",onChange:n=>l(s=>({...s,chargedBy:n.target.value}))})})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Taxes & Fees"}),e.jsx("td",{children:e.jsx("div",{className:"input_charging_de box_crm_input",children:e.jsx("input",{type:"number",className:"form-control box_crm_input_all",value:(a==null?void 0:a.taxes)||"",readOnly:!j,onChange:n=>{const s=n.target.value,t=(a==null?void 0:a.baseFare)||0;l(c=>({...c,taxes:s,totalAmount:Number(t)+Number(s||0)}))}})})}),e.jsx("td",{children:e.jsx("div",{className:"box_crm_input",children:e.jsxs("select",{className:"form-select box_crm_input_all",disabled:!j,value:(a==null?void 0:a.chargingTaxStatus)||"",onChange:n=>l(s=>({...s,chargingTaxStatus:n.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"declined",children:"Declined"}),e.jsx("option",{value:"charged",children:"Charged"}),e.jsx("option",{value:"pending",children:"Pending"})]})})}),e.jsx("td",{children:e.jsx("div",{className:"input_charging_de box_crm_input",children:e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!j,value:(a==null?void 0:a.chargingTaxchargedOn)||"",onChange:n=>l(s=>({...s,chargingTaxchargedOn:n.target.value}))})})}),e.jsx("td",{children:e.jsx("div",{className:"input_charging_de box_crm_input",children:e.jsx("input",{type:"text",className:"form-control box_crm_input_all",readOnly:!j,value:(a==null?void 0:a.chargingTaxchargedBy)||"",onChange:n=>l(s=>({...s,chargingTaxchargedBy:n.target.value}))})})})]})]})]})})})]}),e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Passengers Details",((Ge=i==null?void 0:i.user)==null?void 0:Ge.role)==="superadmin"||((We=i==null?void 0:i.user)==null?void 0:We.role)==="admin"?e.jsx("div",{class:"flex_props gap-2",children:v?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:async()=>{try{await x.patch(`/api/v1/ctmflights/update-passenger-details/${m}`,{passengerDetails:a.passengerDetails}),alert("Passenger details updated!"),ee(!1)}catch{alert("Failed to update passenger details.")}},children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>ee(!0),children:"Edit"})}):null]}),(Ke=a==null?void 0:a.passengerDetails)==null?void 0:Ke.map((n,s)=>e.jsxs("div",{className:v?"":"op_reduce",children:[e.jsxs("p",{className:"title_common_semi1",children:["Passenger ",s+1]}),e.jsxs("div",{className:"flex_all form_box_auth",children:[e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Passenger Type"}),e.jsxs("select",{value:n.detailsType||"",className:"form-control box_crm_input_all",disabled:!v,onChange:t=>{const c=[...a.passengerDetails];c[s]={...c[s],detailsType:t.target.value},l(d=>({...d,passengerDetails:c}))},children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"adult",children:"Adult"}),e.jsx("option",{value:"infant",children:"Infant"}),e.jsx("option",{value:"child",children:"Child"})]})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"First Name"}),e.jsx("input",{type:"text",value:n.firstName||"",className:"form-control box_crm_input_all",readOnly:!v,onChange:t=>{const c=[...a.passengerDetails];c[s]={...c[s],firstName:t.target.value},l(d=>({...d,passengerDetails:c}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Middle Name"}),e.jsx("input",{type:"text",value:n.middleName||"",className:"form-control box_crm_input_all",readOnly:!v,onChange:t=>{const c=[...a.passengerDetails];c[s]={...c[s],middleName:t.target.value},l(d=>({...d,passengerDetails:c}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{className:"form-label",children:"Last Name"}),e.jsx("input",{type:"text",value:n.lastName||"",className:"form-control box_crm_input_all",readOnly:!v,onChange:t=>{const c=[...a.passengerDetails];c[s]={...c[s],lastName:t.target.value},l(d=>({...d,passengerDetails:c}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Gender"}),e.jsxs("select",{value:n.gender||"",className:"form-control box_crm_input_all",disabled:!v,onChange:t=>{const c=[...a.passengerDetails];c[s]={...c[s],gender:t.target.value},l(d=>({...d,passengerDetails:c}))},children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Date of Birth (DOB)"}),e.jsx("input",{type:"text",value:n.dob||"",className:"form-control box_crm_input_all",readOnly:!v,onChange:t=>{const c=[...a.passengerDetails];c[s]={...c[s],dob:t.target.value},l(d=>({...d,passengerDetails:c}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Ticket Number"}),e.jsx("input",{type:"text",value:n.ticketNumber||"",className:"form-control box_crm_input_all",readOnly:!v,onChange:t=>{const c=[...a.passengerDetails];c[s]={...c[s],ticketNumber:t.target.value},l(d=>({...d,passengerDetails:c}))}})]})})]},s)]}))]}),(a==null?void 0:a.secondCardDetails)&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Secondary Card Details",((Qe=i==null?void 0:i.user)==null?void 0:Qe.role)==="superadmin"||((Xe=i==null?void 0:i.user)==null?void 0:Xe.role)==="admin"?e.jsx("div",{className:"flex_props gap-2",children:C?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:async()=>{var n,s,t,c,d,o;try{await x.patch(`/api/v1/ctmFlights/update-billing-details2/${m}`,{cardType2:((n=a==null?void 0:a.secondCardDetails)==null?void 0:n.cardType2)||"",cchName2:((s=a==null?void 0:a.secondCardDetails)==null?void 0:s.cchName2)||"",cardNumber2:((t=a==null?void 0:a.secondCardDetails)==null?void 0:t.cardNumber2)||"",cvv2:((c=a==null?void 0:a.secondCardDetails)==null?void 0:c.cvv2)||"",expiryMonth2:((d=a==null?void 0:a.secondCardDetails)==null?void 0:d.expiryMonth2)||"",expiryYear2:((o=a==null?void 0:a.secondCardDetails)==null?void 0:o.expiryYear2)||""}),alert("Secondary billing details updated!"),ne(!1)}catch(b){console.error(b),alert("Failed to update secondary billing details.")}},children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>ne(!0),children:"Edit"})}):null]}),e.jsxs("div",{className:C?"mt-2 flex_all form_box_auth":"mt-2 flex_all form_box_auth op_reduce",children:[e.jsx("div",{className:"width_control_in15 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Card Type"}),e.jsxs("select",{value:((De=a==null?void 0:a.secondCardDetails)==null?void 0:De.cardType2)||"",className:"form-select box_crm_input_all",disabled:!C,onChange:n=>{l(s=>({...s,secondCardDetails:{...s.secondCardDetails||{},cardType2:n.target.value}}))},children:[e.jsx("option",{value:"",children:"Select"}),f==null?void 0:f.map((n,s)=>e.jsx("option",{value:n.value,children:n.label},s))]})]})}),e.jsx("div",{className:"width_control_in20 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"C.C.H. Name"}),e.jsx("input",{type:"text",value:((ea=a==null?void 0:a.secondCardDetails)==null?void 0:ea.cchName2)||"",className:"form-control box_crm_input_all",readOnly:!C,onChange:n=>{l(s=>({...s,secondCardDetails:{...s.secondCardDetails||{},cchName2:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in30 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Card Number"}),e.jsx("input",{type:k?"text":"password",value:((aa=a==null?void 0:a.secondCardDetails)==null?void 0:aa.cardNumber2)||"",className:"form-control box_crm_input_all",readOnly:!C,onChange:n=>{l(s=>({...s,secondCardDetails:{...s.secondCardDetails||{},cardNumber2:n.target.value}}))},onClick:F})]})}),e.jsx("div",{className:"width_control_in15 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"CVV"}),e.jsx("input",{type:k?"text":"password",value:((na=a==null?void 0:a.secondCardDetails)==null?void 0:na.cvv2)||"",className:"form-control box_crm_input_all",readOnly:!C,onChange:n=>{l(s=>({...s,secondCardDetails:{...s.secondCardDetails||{},cvv2:n.target.value}}))},onClick:F,maxLength:4})]})}),e.jsx("div",{className:"width_control_in10 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Expiry Month"}),e.jsx("input",{type:k?"text":"password",value:((sa=a==null?void 0:a.secondCardDetails)==null?void 0:sa.expiryMonth2)||"",className:"form-control box_crm_input_all",readOnly:!C,onChange:n=>{l(s=>({...s,secondCardDetails:{...s.secondCardDetails||{},expiryMonth2:n.target.value}}))},onClick:F,maxLength:2})]})}),e.jsx("div",{className:"width_control_in10 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Expiry Year"}),e.jsx("input",{type:k?"text":"password",value:((ta=a==null?void 0:a.secondCardDetails)==null?void 0:ta.expiryYear2)||"",className:"form-control box_crm_input_all",readOnly:!C,onChange:n=>{l(s=>({...s,secondCardDetails:{...s.secondCardDetails||{},expiryYear2:n.target.value}}))},onClick:F,maxLength:2})]})})]})]})}),e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Billing Details",((ra=i==null?void 0:i.user)==null?void 0:ra.role)==="superadmin"||((ca=i==null?void 0:i.user)==null?void 0:ca.role)==="admin"?e.jsx("div",{class:"flex_props gap-2",children:h?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:async()=>{try{await x.patch(`/api/v1/ctmFlights/update-billing-details/${m}`,{cardType:a==null?void 0:a.cardType,cchName:a==null?void 0:a.cchName,cardNumber:a==null?void 0:a.cardNumber,cvv:a==null?void 0:a.cvv,expiry:a==null?void 0:a.expiry,expiryMonth:a==null?void 0:a.expiryMonth,expiryYear:a==null?void 0:a.expiryYear,email:a==null?void 0:a.email,billingPhoneNumber:a==null?void 0:a.billingPhoneNumber,billingAddress1:a==null?void 0:a.billingAddress1,billingAddress2:a==null?void 0:a.billingAddress2,city:a==null?void 0:a.city,state:a==null?void 0:a.state,country:a==null?void 0:a.country,zipCode:a==null?void 0:a.zipCode}),alert("Billing details updated!"),ae(!1)}catch{alert("Failed to update billing details.")}},children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>ae(!0),children:"Edit"})}):null]}),e.jsxs("div",{className:h?"mt-2 flex_all form_box_auth":"mt-2 flex_all form_box_auth op_reduce",children:[e.jsx("div",{className:"width_control_in15 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Card Type"}),e.jsxs("select",{value:(a==null?void 0:a.cardType)||"",className:"form-select box_crm_input_all",disabled:!h,onChange:n=>{l(s=>({...s,cardType:n.target.value}))},children:[e.jsx("option",{value:"",children:"Select"}),f==null?void 0:f.map((n,s)=>e.jsx("option",{value:n.value,children:n.label},s))]})]})}),e.jsx("div",{className:"width_control_in20 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"C.C.H. Name"}),e.jsx("input",{type:"text",value:(a==null?void 0:a.cchName)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,cchName:n.target.value}))}})]})}),e.jsx("div",{className:"width_control_in30 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Card Number"}),e.jsx("input",{type:k?"text":"password",value:(a==null?void 0:a.cardNumber)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,cardNumber:n.target.value}))},onClick:F})]})}),e.jsx("div",{className:"width_control_in15 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"CVV"}),e.jsx("input",{type:k?"text":"password",value:(a==null?void 0:a.cvv)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,cvv:n.target.value}))},onClick:F,maxLength:4})]})}),e.jsx("div",{className:"width_control_in10 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Expiry Month"}),e.jsx("input",{type:k?"text":"password",value:(a==null?void 0:a.expiryMonth)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,expiryMonth:n.target.value}))},onClick:F,maxLength:2})]})}),e.jsx("div",{className:"width_control_in10 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Expiry Year"}),e.jsx("input",{type:k?"text":"password",value:(a==null?void 0:a.expiryYear)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,expiryYear:n.target.value}))},onClick:F,maxLength:2})]})}),e.jsx("div",{className:"width_control_in33 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",value:(a==null?void 0:a.email)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,email:n.target.value}))}})]})}),e.jsx("div",{className:"width_control_in33 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Billing Number"}),e.jsx("input",{type:"text",value:(a==null?void 0:a.billingPhoneNumber)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,billingPhoneNumber:n.target.value}))}})]})}),e.jsx("div",{className:"width_control_in33 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Billing Address"}),e.jsx("input",{type:"text",value:(a==null?void 0:a.billingAddress1)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,billingAddress1:n.target.value}))}})]})}),e.jsx("div",{className:"width_control_in33 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Billing Address 2"}),e.jsx("input",{type:"text",value:(a==null?void 0:a.billingAddress2)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,billingAddress2:n.target.value}))}})]})}),e.jsx("div",{className:"width_control_in15 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"City"}),e.jsx("input",{type:"text",value:(a==null?void 0:a.city)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,city:n.target.value}))}})]})}),e.jsx("div",{className:"width_control_in15 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"State"}),e.jsx("input",{type:"text",value:(a==null?void 0:a.state)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,state:n.target.value}))}})]})}),e.jsx("div",{className:"width_control_in15 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Country"}),e.jsx("input",{type:"text",value:(a==null?void 0:a.country)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,country:n.target.value}))}})]})}),e.jsx("div",{className:"width_control_in15 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"ZIP Code"}),e.jsx("input",{type:"text",value:(a==null?void 0:a.zipCode)||"",className:"form-control box_crm_input_all",readOnly:!h,onChange:n=>{l(s=>({...s,zipCode:n.target.value}))}})]})})]})]}),e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Refund Details",((ia=i==null?void 0:i.user)==null?void 0:ia.role)==="superadmin"||((la=i==null?void 0:i.user)==null?void 0:la.role)==="admin"?e.jsx("div",{className:"flex_props gap-2",children:N?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:async()=>{var n,s,t,c,d;try{const o={refundAmount:"Refund Amount",refundRequestedOn:"Refund Request Date",reasonForRefund:"Refund Reason",refundStatus:"Refund Status"};for(const b in o)if(!((n=a==null?void 0:a.refund)!=null&&n[b])){B.error(`${o[b]} is required`);return}await x.patch(`/api/v1/ctmFlights/update-refund-details/${m}`,{refundAmount:(s=a==null?void 0:a.refund)==null?void 0:s.refundAmount,refundRequestedOn:(t=a==null?void 0:a.refund)==null?void 0:t.refundRequestedOn,reasonForRefund:(c=a==null?void 0:a.refund)==null?void 0:c.reasonForRefund,refundStatus:(d=a==null?void 0:a.refund)==null?void 0:d.refundStatus}),alert("Refund details updated!"),L(!1)}catch{alert("Failed to update refund details.")}},children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>L(!0),children:"Edit"})}):null]}),e.jsxs("div",{className:N?"mt-2 flex_all form_box_auth":"mt-2 flex_all form_box_auth op_reduce",children:[e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Amount"}),e.jsx("input",{type:"text",value:(da=a==null?void 0:a.refund)==null?void 0:da.refundAmount,className:"form-control box_crm_input_all",readOnly:!N,onChange:n=>{l(s=>({...s,refund:{...(s==null?void 0:s.refund)||{},refundAmount:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Refund Requested On"}),e.jsx("input",{type:"text",value:(oa=a==null?void 0:a.refund)==null?void 0:oa.refundRequestedOn,className:"form-control box_crm_input_all",readOnly:!N,onChange:n=>{l(s=>({...s,refund:{...(s==null?void 0:s.refund)||{},refundRequestedOn:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Reason for Refund"}),e.jsx("input",{type:"text",value:(ua=a==null?void 0:a.refund)==null?void 0:ua.reasonForRefund,className:"form-control box_crm_input_all",readOnly:!N,onChange:n=>{l(s=>({...s,refund:{...(s==null?void 0:s.refund)||{},reasonForRefund:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Refund Status"}),e.jsx("input",{type:"text",value:(ma=a==null?void 0:a.refund)==null?void 0:ma.refundStatus,className:"form-control box_crm_input_all",disabled:!N,onChange:n=>{l(s=>({...s,refund:{...(s==null?void 0:s.refund)||{},refundStatus:n.target.value}}))}})]})})]})]}),e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["ChargeBack Details",((xa=i==null?void 0:i.user)==null?void 0:xa.role)==="superadmin"||((_a=i==null?void 0:i.user)==null?void 0:_a.role)==="admin"?e.jsx("div",{className:"flex_props gap-2",children:w?e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:async()=>{var n,s,t,c,d;try{const o={chargeAmount:"Charge Amount",chargebackDate:"Chargeback Date",reasonForChargeback:"Reason for Chargeback",chargebackStatus:"Chargeback Status"};for(const b in o)if(!((n=a==null?void 0:a.chargeBackDetails)!=null&&n[b])){B.error(`${o[b]} is required!`);return}await x.patch(`/api/v1/ctmFlights/update-chargeBack-details/${m}`,{chargeAmount:(s=a==null?void 0:a.chargeBackDetails)==null?void 0:s.chargeAmount,chargebackDate:(t=a==null?void 0:a.chargeBackDetails)==null?void 0:t.chargebackDate,reasonForChargeback:(c=a==null?void 0:a.chargeBackDetails)==null?void 0:c.reasonForChargeback,chargebackStatus:(d=a==null?void 0:a.chargeBackDetails)==null?void 0:d.chargebackStatus}),alert("Chargeback details updated!"),se(!1)}catch{alert("Failed to update charging details.")}},children:"Submit"}):e.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>se(!0),children:"Edit"})}):null]}),e.jsxs("div",{className:w?"mt-2 flex_all form_box_auth":"mt-2 flex_all form_box_auth op_reduce",children:[e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Amount"}),e.jsx("input",{type:"text",value:(ha=a==null?void 0:a.chargeBackDetails)==null?void 0:ha.chargeAmount,className:"form-control box_crm_input_all",readOnly:!w,onChange:n=>{l(s=>({...s,chargeBackDetails:{...(s==null?void 0:s.chargeBackDetails)||{},chargeAmount:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Chargeback Date"}),e.jsx("input",{type:"text",value:(pa=a==null?void 0:a.chargeBackDetails)==null?void 0:pa.chargebackDate,className:"form-control box_crm_input_all",readOnly:!w,onChange:n=>{l(s=>({...s,chargeBackDetails:{...(s==null?void 0:s.chargeBackDetails)||{},chargebackDate:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Reason for Chargeback"}),e.jsx("input",{type:"text",value:(ba=a==null?void 0:a.chargeBackDetails)==null?void 0:ba.reasonForChargeback,className:"form-control box_crm_input_all",readOnly:!w,onChange:n=>{l(s=>({...s,chargeBackDetails:{...(s==null?void 0:s.chargeBackDetails)||{},reasonForChargeback:n.target.value}}))}})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Chargeback Status"}),e.jsx("input",{type:"text",value:(ja=a==null?void 0:a.chargeBackDetails)==null?void 0:ja.chargebackStatus,className:"form-control box_crm_input_all",disabled:!w,onChange:n=>{l(s=>({...s,chargeBackDetails:{...(s==null?void 0:s.chargeBackDetails)||{},chargebackStatus:n.target.value}}))}})]})})]})]}),e.jsxs("div",{className:"box_crm_tr margin_box_tr",children:[e.jsx("p",{className:"title_common_semi",children:"Send Email"}),e.jsxs("div",{className:"mt-2 flex_all form_box_auth",children:[e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Language"}),e.jsxs("select",{value:a==null?void 0:a.language,className:"form-select box_crm_input_all",onChange:n=>l(s=>({...s,language:n.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Spanish"})]})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Transaction Type"}),e.jsxs("select",{value:a==null?void 0:a.transactionType,className:"form-select box_crm_input_all",onChange:n=>l(s=>({...s,transactionType:n.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"newBooking",children:"New Booking"}),e.jsx("option",{value:"exchange",children:"Exchange"}),e.jsx("option",{value:"seatAssignments",children:"Seat Assignments"}),e.jsx("option",{value:"upgrade",children:"Upgrade"}),e.jsx("option",{value:"cancellationRefund",children:"Cancellation for Refund"}),e.jsx("option",{value:"cancellationFutureCredit",children:"Cancellation for Future Credit"}),e.jsx("option",{value:"extraAddOn",children:"Extra Add On"}),e.jsx("option",{value:"ticketIssuance",children:"Ticket Issuance"})]})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsxs("div",{className:"box_crm_input",children:[e.jsx("label",{children:"Mail Confirmation"}),e.jsxs("select",{value:a.agentFigure?a.agentFigure:"loading...",className:"form-select box_crm_input_all",onChange:n=>l(s=>({...s,agentFigure:n.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"yes",children:"Yes"}),e.jsx("option",{value:"no",children:"No"})]})]})}),e.jsx("div",{className:"width_control_in25 box_sp",children:e.jsx("button",{className:(a==null?void 0:a.agentFigure)!=="yes"?"send_in_btn disabled":"send_in_btn",onClick:oe,title:(a==null?void 0:a.ticketmco)==="ticketMco"&&(a==null?void 0:a.chargingStatus)==="charged"&&(a==null?void 0:a.pnrStatus)==="approved"?"":"Send Email is only available when Bid Status is 'Ticketed & MCO', Charging Status is 'charged', and Auth Status is 'approved'.",children:"Send Email"})})]})]})]})})]}),e.jsxs("div",{className:"fixed_btns_all_pnr",children:[e.jsx("button",{className:"btn_stick",onClick:()=>G(!0),children:"View Remarks"}),e.jsx("button",{className:"btn_stick",onClick:()=>K(!0),children:"Check Activity"}),e.jsx("button",{className:"btn_stick",onClick:()=>ie(!0),children:"Uploaded Docs"})]}),ln&&e.jsx("div",{className:"log_all_pop",children:e.jsxs("div",{className:"log_pop_semi",children:[e.jsxs("p",{className:"log_header flex_props justify-content-between",children:["Uploaded Documents",e.jsxs("button",{type:"button",className:"log_close",onClick:()=>ie(!1),children:[" ",e.jsx("img",{src:"/imgs/close-icon.png"})]})]}),e.jsx("div",{className:"bid_table",children:((Na=a==null?void 0:a.documents)==null?void 0:Na.length)===0?e.jsx("p",{children:"No documents uploaded yet."}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"S. No"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Image"})]})}),e.jsx("tbody",{children:(va=a.documents)==null?void 0:va.map((n,s)=>{const t=`http://localhost:8000/uploads/${n}`;return e.jsxs("tr",{children:[e.jsx("td",{children:s+1}),e.jsx("td",{children:n}),e.jsx("td",{children:e.jsx("a",{href:t,download:n,target:"_blank",children:e.jsx("img",{src:t,alt:"document",style:{width:60,height:60,objectFit:"cover",borderRadius:4,border:"1px solid #eee"}})})})]},`doc-${s}`)})})]})})})})]})})]})};export{On as default};
