import{r as p,g as j,V as r,b as x,j as s}from"./index-DDoEHnfR.js";import{L as u}from"./Layout-Co7qzEc2.js";import{S as f}from"./SideBar-DCoEgSRU.js";import{h as _}from"./moment-G82_0lEo.js";const c=j(),O=()=>{var h;const[a,d]=p.useState([]);p.useEffect(()=>(i(),c.on("otpInserted",e=>{r.success("New OTP inserted!"),i()}),c.on("otpUpdated",e=>{r.success("OTP updated!"),i()}),c.on("error",e=>{r.error(e.message||"Socket error")}),()=>{c.off("otpInserted"),c.off("otpUpdated"),c.off("error")}),[]);const i=async()=>{try{const e=await x.get("/api/v1/auth/get-otp-all");e!=null&&e.data?d(e.data):d([])}catch(e){console.error("Error fetching admins:",e)}},m=async(e,l,n)=>{var o;try{const t=await x.post(`/api/v1/auth/agent-otp-status/${e}`,{otpEmail:l,otpStatus:n});(o=t==null?void 0:t.data)!=null&&o.success?(r.success(t.data.message),await i()):r.error(t.data.message||"Something went wrong!")}catch(t){console.error("Error updating OTP status:",t),r.error("Failed to update status!")}};return s.jsx(u,{children:s.jsxs("main",{class:"crm_all_body d-flex",children:[s.jsx(f,{}),s.jsxs("div",{className:"crm_right relative",children:[s.jsx("section",{className:"",children:s.jsx("div",{className:"header_crm flex_props justify-content-between",children:s.jsx("p",{className:"crm_title",children:"Astrivion Ventures OTP Access Of All Employees"})})}),s.jsx("section",{children:s.jsxs("div",{className:"box_crm_tr",children:[s.jsx("p",{className:"title_common_semi",children:"Share OTP"}),s.jsx("div",{className:"bid_bg mt-4",children:s.jsx("div",{className:"bid_table",children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{scope:"col",children:"S.No."}),s.jsx("th",{scope:"col",children:"Name"}),s.jsx("th",{scope:"col",children:"Email"}),s.jsx("th",{scope:"col",children:"Number"}),s.jsx("th",{scope:"col",children:"Role"}),s.jsx("th",{scope:"col",children:"Otp"}),s.jsx("th",{scope:"col",children:"Expired At"}),s.jsx("th",{scope:"col",children:"Send Otp"})]})}),s.jsx("tbody",{children:((h=a==null?void 0:a.data)==null?void 0:h.length)>0?a.data.map((e,l)=>{var n,o,t;return s.jsxs("tr",{children:[s.jsx("th",{scope:"row",children:l+1}),s.jsx("td",{children:e.userName}),s.jsx("td",{children:e.email}),s.jsx("td",{children:e.number||"-"}),s.jsx("td",{children:e.role}),s.jsx("td",{children:((n=e==null?void 0:e.otp)==null?void 0:n.value)||"-"}),s.jsx("td",{children:(o=e==null?void 0:e.otp)!=null&&o.expiresAt?_(e.otp.expiresAt).format("YYYY-MM-DD HH:mm:ss"):"-"}),s.jsx("td",{children:(t=e==null?void 0:e.otp)!=null&&t.value?s.jsx("button",{className:"send_auth_again color_btn_ch",onClick:()=>m(e._id,e.email,e.otp.value),children:"Send Otp"}):"-"})]},e._id)}):s.jsx("tr",{children:s.jsx("td",{colSpan:"8",className:"text-center",children:s.jsx("h1",{children:"Not available"})})})})]})})})})]})})]})]})})};export{O as default};
