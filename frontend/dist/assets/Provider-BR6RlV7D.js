import{r as n,j as e,b as x,V as o}from"./index-DDoEHnfR.js";import{L as $}from"./Layout-Co7qzEc2.js";import{S as T}from"./SideBar-DCoEgSRU.js";const B=()=>{const[m,C]=n.useState([]),[w,j]=n.useState(!1),[i,_]=n.useState({provider:"",status:"",tollFreePrimary:"",tollFreeSecondary:"",providerAddress:""}),[v,F]=n.useState(!1),[g,b]=n.useState([]),[S,f]=n.useState([]),[I,y]=n.useState(!1),[d,P]=n.useState({provider:"",status:""}),[E,q]=n.useState(null),[N,A]=n.useState(!1),u=async()=>{var s;try{const r=await x.get("/api/v1/ctmFlights/get-provider");r.data.success?C((s=r==null?void 0:r.data)==null?void 0:s.booking):console.error("Failed to fetch current provider.jsx percentage.")}catch(r){console.error("Error fetching current provider.jsx percentage:",r)}};n.useEffect(()=>{u()},[]);const D=async s=>{var r,l;try{const a=await x.delete(`/api/v1/ctmFlights/delete-provider/${s}`);(r=a==null?void 0:a.data)!=null&&r.success?(o.success((l=a==null?void 0:a.data)==null?void 0:l.message),u()):o.error("Failed to delete provider.")}catch(a){console.error("Error deleting provider:",a),o.error("An error occurred while deleting the provider.")}},h=s=>{_({...i,[s.target.name]:s.target.value})},k=s=>{const r=Array.from(s.target.files);b(l=>[...l,...r]),f(l=>[...l,...r.map(a=>URL.createObjectURL(a))])},L=async s=>{var r,l,a;s.preventDefault(),F(!0);try{const t=new FormData;t.append("provider",i.provider),t.append("providerAddress",i.providerAddress),t.append("status",i.status),t.append("tollFreePrimary",i.tollFreePrimary),t.append("tollFreeSecondary",i.tollFreeSecondary),g.forEach(U=>{t.append("providerImages",U)});const c=await x.post("/api/v1/ctmFlights/create-provider",t,{headers:{"Content-Type":"multipart/form-data"}});(r=c==null?void 0:c.data)!=null&&r.success?(o.success((l=c==null?void 0:c.data)==null?void 0:l.message),j(!1),_({provider:"",status:"",tollFreePrimary:"",tollFreeSecondary:""}),b([]),f([]),u()):o.error((a=c==null?void 0:c.data)==null?void 0:a.message)}catch{o.error("An error occurred while adding the provider.")}F(!1)},M=s=>{q(s._id),P({provider:s.provider||"",tollFreePrimary:s.tollFreePrimary||"",tollFreeSecondary:s.tollFreeSecondary||"",status:s.providerStatus||""}),y(!0)},p=s=>{P({...d,[s.target.name]:s.target.value})},R=async s=>{var r,l,a;s.preventDefault(),A(!0);try{const t=await x.put(`/api/v1/ctmFlights/update-provider/${E}`,{provider:d.provider,providerAddress:d.providerAddress,tollFreePrimary:d.tollFreePrimary,tollFreeSecondary:d.tollFreeSecondary,status:d.status});(r=t==null?void 0:t.data)!=null&&r.success?(o.success(((l=t==null?void 0:t.data)==null?void 0:l.message)||"Provider updated successfully"),y(!1),u()):o.error(((a=t==null?void 0:t.data)==null?void 0:a.message)||"Failed to update provider")}catch{o.error("An error occurred while updating the provider.")}A(!1)};return e.jsx(e.Fragment,{children:e.jsx($,{children:e.jsxs("main",{class:"crm_all_body d-flex",children:[e.jsx(T,{}),e.jsxs("div",{className:"crm_right relative",children:[e.jsx("section",{className:"",children:e.jsx("div",{className:"header_crm flex_props justify-content-between",children:e.jsx("p",{className:"crm_title",children:"Dynamic Providers"})})}),e.jsx("section",{children:e.jsxs("div",{className:"box_crm_tr",children:[e.jsxs("p",{className:"title_common_semi flex_props justify-content-between",children:["Added Provider Detail",e.jsx("div",{children:e.jsxs("p",{onClick:()=>j(!0),className:"provider_btnn",children:[e.jsx("img",{src:"/imgs/add.png"}),"Add Provider"]})})]}),e.jsx("div",{className:"bid_bg mt-4",children:e.jsxs("div",{className:"bid_table",children:[w&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:e.jsxs("div",{className:"provider_semi_semi",children:[e.jsx("h4",{className:"add_pr_title",children:"Add Provider Details"}),e.jsx("hr",{className:"my-3"}),e.jsxs("form",{onSubmit:L,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Provider Name"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"provider",value:i.provider,onChange:h,required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Provider Address"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"providerAddress",value:i.providerAddress,onChange:h,required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("label",{className:"form-label",children:["Toll Free Number (Primary)",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"tollFreePrimary",value:i.tollFreePrimary,onChange:h,required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Toll Free Number (Secondary Optional)"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"tollFreeSecondary",value:i.tollFreeSecondary,onChange:h})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select form_in_pr",name:"status",value:i.status,onChange:h,required:!0,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Provider Image"}),e.jsx("input",{type:"file",multiple:!0,name:"providerImages",className:"form-control form_in_pr",onChange:k,required:!0}),e.jsx("div",{className:"",children:S.length>0&&S.map((s,r)=>e.jsx("img",{src:s,alt:"preview",style:{width:60,height:60,objectFit:"cover",borderRadius:4,border:"1px solid #eee"}},r))}),e.jsx("div",{className:"mt-2",children:g.length>0&&g.map((s,r)=>e.jsx("div",{children:s.name},r))})]}),e.jsxs("div",{className:"flex_props gap-2 mt-3 justify-content-end",children:[e.jsx("button",{type:"submit",className:"btn_provider_pop btn_provider_pop_add",disabled:v,children:v?"Adding...":"Add"}),e.jsx("button",{type:"button",className:"btn_provider_pop",onClick:()=>{j(!1),b([]),f([])},disabled:v,children:"Cancel"})]})]})]})}),I&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:e.jsxs("div",{className:"provider_semi_semi",children:[e.jsx("h4",{className:"add_pr_title",children:"Edit Provider"}),e.jsx("hr",{className:"my-3"}),e.jsxs("form",{onSubmit:R,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Provider Name"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"provider",value:d.provider,onChange:p,required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Provider Image"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"providerAddress",value:d.providerAddress,onChange:p,required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Primary Number"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"tollFreePrimary",value:d.tollFreePrimary,onChange:p,required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Secondary Number"}),e.jsx("input",{type:"text",className:"form-control form_in_pr",name:"tollFreeSecondary",value:d.tollFreeSecondary,onChange:p,required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-control form_in_pr",name:"status",value:d.status,onChange:p,required:!0,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex_props gap-2 mt-3 justify-content-end",children:[e.jsx("button",{type:"submit",className:"btn_provider_pop btn_provider_pop_add",disabled:N,children:N?"Updating...":"Update"}),e.jsx("button",{type:"button",className:"btn_provider_pop",onClick:()=>y(!1),disabled:N,children:"Cancel"})]})]})]})}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"image"}),e.jsx("th",{children:"Provider Name"}),e.jsx("th",{children:" Provider image"}),e.jsx("th",{children:"Primary"}),e.jsx("th",{children:"Secondary"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:m&&m.length>0?m==null?void 0:m.map((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"corp-img",children:e.jsx("div",{style:{display:"flex",justifyContent:"center"},children:s==null?void 0:s.providerPictures.map(l=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"productImgContainer crud-table-img",children:e.jsx("img",{src:`http://localhost:8000/uploads/${l.img}`,alt:"images",style:{width:120,height:60,objectFit:"contain",borderRadius:4,padding:10,border:"1px solid #eee"}})})}))})}),e.jsx("td",{children:(s==null?void 0:s.provider)||"-"}),e.jsxs("td",{children:[" ",s==null?void 0:s.providerAddress," "]}),e.jsx("td",{children:(s==null?void 0:s.tollFreePrimary)||"-"}),e.jsx("td",{children:(s==null?void 0:s.tollFreeSecondary)||"-"}),e.jsx("td",{className:(s==null?void 0:s.providerStatus)==="Active"?"text-success  text-center ":"text-warning text-center",children:(s==null?void 0:s.providerStatus)||"-"}),e.jsx("td",{className:"action_provider",children:e.jsxs("div",{class:"action_provider_btn_main",children:[e.jsxs("button",{className:"action_provider_btn",onClick:()=>M(s),children:[e.jsx("img",{src:"/imgs/edit.png"}),"Edit"]}),e.jsxs("button",{className:"action_provider_btn action_provider_dlt",onClick:()=>D(s._id),children:[e.jsx("img",{src:"/imgs/delete-i.png"}),"Delete"]})]})})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No provider data available"})})})]})})]})})]})})]})]})})})};export{B as default};
