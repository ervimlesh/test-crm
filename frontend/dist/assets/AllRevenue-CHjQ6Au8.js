import{f as E,r as l,j as e}from"./index-DDoEHnfR.js";import{L as R}from"./Layout-Co7qzEc2.js";import{S as L}from"./SideBar-DCoEgSRU.js";import{D as y}from"./index.es-_Aq59fjB.js";import"./clsx-B-dksMZM.js";const U=()=>{const{ctmFlightDeals:p}=E(),b=()=>{const t=new Date;return{start:new Date(t.getFullYear(),t.getMonth(),1),end:new Date}},{start:g,end:j}=b(),[f,T]=l.useState(g),[v,N]=l.useState(j),[D,A]=l.useState({transactionType:""}),[d,_]=l.useState(g),[h,M]=l.useState(j),[u,w]=l.useState(""),m=l.useMemo(()=>p.filter(t=>{var s;if(!Array.isArray(t.logActivity))return!1;const n=t.logActivity.filter(a=>a.type==="bid-status-update");if(n.length===0)return!1;const i=n.reduce((a,r)=>new Date(r.updatedAt)>new Date(a.updatedAt)?r:a);return((s=i==null?void 0:i.data)==null?void 0:s.ticketmco)==="ticketMco"}),[p]);console.log("approvedFlights",m);const x=l.useMemo(()=>m.filter(t=>{const n=t.logActivity.filter(o=>o.type==="bid-status-update");if(n.length===0)return!1;const i=n.reduce((o,F)=>new Date(F.updatedAt)>new Date(o.updatedAt)?F:o),s=new Date(i.updatedAt),a=d?new Date(d):null,r=h?new Date(h):null,k=!a||s.getFullYear()>a.getFullYear()||s.getFullYear()===a.getFullYear()&&s.getMonth()>a.getMonth()||s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()&&s.getDate()>=a.getDate(),C=!r||s.getFullYear()<r.getFullYear()||s.getFullYear()===r.getFullYear()&&s.getMonth()<r.getMonth()||s.getFullYear()===r.getFullYear()&&s.getMonth()===r.getMonth()&&s.getDate()<=r.getDate(),S=k&&C,B=!u||t.transactionType===u;return S&&B}),[m,d,h,u]),c=l.useMemo(()=>x.reduce((t,n)=>(t.baseFare+=Number(n.baseFare||0),t.taxes+=Number(n.taxes||0),t),{baseFare:0,taxes:0}),[x]),Y=()=>{_(f),M(v),w(D.transactionType)};return e.jsx(R,{children:e.jsxs("main",{className:"crm_all_body d-flex",children:[e.jsx(L,{}),e.jsxs("div",{className:"crm_right relative",children:[e.jsx("div",{className:"header_crm flex_props justify-content-between",children:e.jsx("p",{className:"crm_title",children:"Total Revenue"})}),e.jsx("div",{className:"mt-3 mb-2",children:e.jsxs("div",{className:"row bid_cont",children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"bids_inn_fresh",children:[e.jsxs("label",{children:[e.jsx("img",{src:"/imgs/search-icon.png"}),"From Date"]}),e.jsx(y,{selected:f,onChange:t=>T(t),placeholderText:"Enter Pickup Date",dateFormat:"MM-dd-yyyy",className:"form-control",maxDate:new Date,name:"fromDate",id:"start-date"})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"bids_inn_fresh",children:[e.jsxs("label",{children:[e.jsx("img",{src:"/imgs/date-icon.png"})," To Date"]}),e.jsx(y,{selected:v,onChange:t=>N(t),placeholderText:"Enter Pickup Date",dateFormat:"MM-dd-yyyy",className:"form-control",name:"toDate",id:"end-date"})]})}),e.jsx("div",{className:"col-3",children:e.jsx("div",{className:"bids_inn_fresh",children:e.jsxs("div",{className:"bids_inn_fresh_in",children:[e.jsx("label",{children:"Transaction Type"}),e.jsx("div",{className:"select_minus",children:e.jsxs("select",{value:D.transactionType,className:"form-select",onChange:t=>A(n=>({...n,transactionType:t.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"newBooking",children:"New Booking"}),e.jsx("option",{value:"exchange",children:"Exchange"}),e.jsx("option",{value:"seatAssignments",children:"Seat Assignments"}),e.jsx("option",{value:"upgrade",children:"Upgrade"}),e.jsx("option",{value:"cancellationRefund",children:"Cancellation for Refund"}),e.jsx("option",{value:"cancellationFutureCredit",children:"Cancellation for Future Credit"}),e.jsx("option",{value:"extraAddOn",children:"Extra Add On"}),e.jsx("option",{value:"ticketIssuance",children:"Ticket Issuance"})]})})]})})}),e.jsx("div",{className:"col-2",children:e.jsx("div",{className:"bids_inn_fresh1",children:e.jsx("button",{onClick:Y,className:"apply_btn_filter",children:"Apply Filter"})})})]})}),e.jsx("div",{className:"bid_table",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Total Approved Bookings"}),e.jsx("th",{children:"Total Base Fares"}),e.jsx("th",{children:"Total Taxes & Fees"}),e.jsx("th",{children:"Grand Total"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:x.length}),e.jsxs("td",{children:["$",c.baseFare]}),e.jsxs("td",{children:["$",c.taxes]}),e.jsxs("td",{children:["$",c.baseFare+c.taxes]})]})})]})})})]})]})})};export{U as default};
