import{n as _,o as y,r as a,i as M,j as i,N as o,b as B,p as C}from"./index-DDoEHnfR.js";C();const V=()=>{var f;const{flightDeals:m,setFlightDeals:R}=_(),{hotelDeals:k,setHotelDeals:P}=y(),[c,x]=a.useState(!0),w=m.filter(s=>s.status==="newBooking").length,[D,A]=a.useState(w),[g,N]=a.useState(null),[O,S]=a.useState([]),[F,E]=a.useState(!0),[j,v]=a.useState(""),[q,d]=a.useState(""),l=M(),T=localStorage.getItem("auth"),p=JSON.parse(T),n=(f=p==null?void 0:p.user)==null?void 0:f.role;a.useEffect(()=>{const s=m.filter(e=>e.status==="newBooking").length;A(s)},[m]),a.useEffect(()=>{(async()=>{var e,r;try{const t=await B.get("/api/v1/flights/get-booking-mails");(e=t.data)!=null&&e.success?(N(t.data.ctmFlightMails||[]),S(t.data.ctmFlightMails||[])):console.error("Failed to fetch booking mails:",(r=t.data)==null?void 0:r.message)}catch(t){console.error("Error fetching booking mails:",t)}})()},[]);const h=a.useMemo(()=>{if(!Array.isArray(g)||g.length===0)return[];const s=new Set(g.map(e=>JSON.stringify({url:e==null?void 0:e.webUrl,mail:e==null?void 0:e.webMail})));return Array.from(s).map(e=>{try{return JSON.parse(e)}catch{return null}}).filter(e=>e&&(e.url||e.mail))},[g]);m.filter(s=>s.status==="newBooking"&&s.webUrl==="faresway.com").length;const u=m.filter(s=>s.status==="newBooking"&&s.webUrl==="traveloways.com").length;m.filter(s=>s.status==="newBooking"&&s.webUrl==="businessclassflyers.com").length;const b=a.useMemo(()=>{let s=[];return n==="employee"&&s.push({id:"employee-management",name:"Employee Management",subTabs:[{name:"Profile",path:"/astrivion/single-employee"}]}),n==="hr"&&s.push({id:"hr-management",name:"HR Management",subTabs:[{name:"Attendance",path:"/astrivion/data-attendance"}]}),n==="account"&&s.push({id:"account-management",name:"Account Management",subTabs:[{name:"Attendance",path:"/astrivion/data-attendance"}]}),n==="marketing"&&s.push({id:"marketing-management",name:"Marketing Management",subTabs:[{name:"AllVoiceRecord",path:"/astrivion/all-voice-record"}]}),s.push({id:"time-management",name:"Time Management",subTabs:[{name:"Punch In/Out",path:"/astrivion/single-employee"}]}),(n==="superadmin"||n==="admin"||n==="agent")&&(s.push({name:"PNRS",path:"/",img:"/imgs/pnr-icon.png",imgDrop:"/imgs/down-icon.png",subTabs:[{name:"All BIDS",path:"/astrivion/all-ctm-booking",img:"/imgs/pnr-icon.png"},{name:i.jsx("span",{children:"Create PNR"}),path:"/astrivion/create-flight-booking",img:"/imgs/pnr-icon.png",imgDrop:"/imgs/down-icon.png"},{name:i.jsx("span",{children:"Create Ship PNR"}),path:"/astrivion/create-ship-booking",img:"/imgs/pnr-icon.png",imgDrop:"/imgs/down-icon.png"}]}),s.push({name:"Agents",path:"/",img:"/imgs/agents-icon1.png",imgDrop:"/imgs/down-icon.png",subTabs:[{name:"All Agents",path:"/astrivion/all-agents",img:"/imgs/register-icon.png"},{name:"Add Call Log Details",path:"/astrivion/voice-detail",img:"/imgs/register-icon.png"}]}),s.push({name:i.jsxs("span",{children:["Traveloways",u>0&&i.jsx("span",{className:"badge bg-danger ms-2",children:u})]}),path:"/",subTabs:[{name:"Booking",path:"/astrivion/traveloways-booking"}]}),h.length>0&&s.push({name:"Deal's Mails",path:"/",subTabs:h.map((e,r)=>({name:e.url?e.url.replace(".com",""):`Mail ${r+1}`,path:e.url?`/astrivion/booking-mails?url=${encodeURIComponent(e.url)}`:"#"}))})),n==="superadmin"?s.unshift({name:"SuperAdmin",path:"/",img:"/imgs/admin-icon-side.png",imgDrop:"/imgs/down-icon.png",subTabs:[{name:"Register Agents",path:"/astrivion/super-admin-register",img:"/imgs/register-icon.png"},{name:"Registration / Registered",path:"/astrivion/all-register-user",img:"/imgs/register-icon.png"},{name:"Otp Access",path:"/astrivion/login-otp",img:"/imgs/otp-icon.png"},{name:"Provider",path:"/astrivion/provider",img:"/imgs/provider-icon.png"},{name:"Auth & Invoice Mails",path:"/astrivion/auth-mails",img:"/imgs/provider-icon.png"},{name:"Add Airlines",path:"/astrivion/add-airline",img:"/imgs/airlines-icon1.png"},{name:"Add Airlines Class | Currency | Card",path:"/astrivion/add-currency-card",img:"/imgs/add-icon.png"},{name:"Charging & Refund Details",path:"/astrivion/charging-refund-details",img:"/imgs/add-icon.png"}]},{name:"Admins",path:"/",img:"/imgs/admins-icon.png",imgDrop:"/imgs/down-icon.png",subTabs:[{name:"Registration Request",path:"/astrivion/admin-register-request",img:"/imgs/registration-request-icon.png"},{name:"Otp Access",path:"/astrivion/otp-login",img:"/imgs/otp-icon.png"}]}):n==="admin"&&s.unshift({name:"Admins",path:"/",subTabs:[{name:"All Admins",path:"/astrivion/all-admins"},{name:"Admin Booking",path:"/astrivion/admin-booking"},{name:"Registration Request",path:"/astrivion/admin-register-request"},{name:"Otp Access",path:"/astrivion/otp-login"}]}),s},[n,h,u]);return a.useEffect(()=>{const s=l.pathname+l.search,e=b.find(r=>r.subTabs.some(t=>t.path===s));if(v(e?e.name:""),e){const r=e.subTabs.find(t=>t.path===s);d(r?r.name:"")}else d("")},[l.pathname,l.search,b]),k.filter(s=>s.status==="newBooking").length,i.jsxs(i.Fragment,{children:[i.jsx("button",{className:c?"dashboard_show":"dashboard_show dashboard_show_ac",onClick:()=>{x(!c)},children:i.jsx("img",{src:"/imgs/dashboard-icon.png"})}),i.jsxs("aside",{className:c?"crm_aside_c white":"crm_aside_c white crm_aside_c_none",children:[i.jsxs("div",{className:"crm_logo white text-center relative",children:[i.jsx("img",{src:"/imgs/logo.png"}),i.jsx("button",{className:"aside_btnn",onClick:()=>{x(!c)},children:i.jsx("img",{src:"/imgs/arrow-right.png"})})]}),i.jsx("div",{className:"main_m",children:i.jsx("p",{children:"Menu Astrivion Ventures"})}),i.jsx("div",{className:"crm_ul_li",children:i.jsxs("ul",{children:[i.jsx("li",{children:i.jsxs(o,{to:"/",children:[i.jsx("div",{className:"crm_icons",children:i.jsx("img",{src:"/imgs/dashboard-icon.png"})}),i.jsx("p",{children:" Dashboard"})]})}),b.map(s=>i.jsxs("li",{children:[i.jsxs(o,{to:s.path||"/",onClick:()=>v(j===s.name?"":s.name),children:[i.jsx("div",{className:"crm_icons",children:i.jsx("img",{src:s.img})}),i.jsxs("p",{children:[" ",s.name]}),i.jsx("div",{className:"drop_img",children:i.jsx("img",{src:s.imgDrop})})]}),j===s.name&&i.jsx("ul",{className:"sup_em",children:s.subTabs.map(e=>i.jsx("li",{children:i.jsxs(o,{to:e.path,onClick:()=>d(e.name),children:[i.jsx("div",{className:"crm_icons",children:i.jsx("img",{src:e.img})}),i.jsx("p",{children:e.name})]})},e.name))})]},s.name)),n!=="employee"&&n!=="marketing"&&n!=="hr"&&n!=="account"&&i.jsxs(i.Fragment,{children:[i.jsxs("li",{children:[i.jsx("li",{children:i.jsxs(o,{to:"/astrivion/find-booking",children:[i.jsx("div",{className:"crm_icons",children:i.jsx("img",{src:"/imgs/booking-i.png"})}),i.jsx("p",{children:"Find Booking"})]})}),i.jsxs(o,{to:"/astrivion/top-performers",children:[i.jsx("div",{className:"crm_icons",children:i.jsx("img",{src:"/imgs/admin-icon1.png"})})," ",i.jsx("p",{children:" Top Performers"})]})]}),i.jsx("li",{children:i.jsxs(o,{to:"/astrivion/my-performance",children:[i.jsx("div",{className:"crm_icons",children:i.jsx("img",{src:"/imgs/performance-icon.png"})}),i.jsx("p",{children:"My Performance"})]})}),i.jsx("li",{children:i.jsxs(o,{to:"/astrivion/work-space",children:[i.jsx("div",{className:"crm_icons",children:i.jsx("img",{src:"/imgs/online-sheet-icon1.png"})}),i.jsx("p",{children:"Online WorkSheet"})]})})]})]})})]})]})};export{V as S};
