import{r as l,b as x,j as t,V as n}from"./index-DDoEHnfR.js";import{L as p}from"./Layout-Co7qzEc2.js";import{S as j}from"./SideBar-DCoEgSRU.js";import{h as u}from"./moment-G82_0lEo.js";const N=()=>{var d;const[i,o]=l.useState([]);l.useEffect(()=>{h()},[]);const h=async()=>{try{const s=await x.get("/api/v1/auth/get-otp-agent");s!=null&&s.data?o(s.data):o([])}catch(s){console.error("Error fetching admins:",s)}},m=async(s,c,a)=>{var r;try{const e=await x.post(`/api/v1/auth/agent-otp-status/${s}`,{otpEmail:c,otpStatus:a});(r=e==null?void 0:e.data)!=null&&r.success?(n.success(e.data.message),await h(),console.log("OTP status updated:",e.data)):n.error(e.data.message||"Something went wrong!")}catch(e){console.error("Error updating OTP status:",e),n.error("Failed to update status!")}};return t.jsx(p,{children:t.jsxs("main",{class:"crm_all_body d-flex",children:[t.jsx(j,{}),t.jsxs("div",{className:"crm_right relative",children:[t.jsx("div",{className:"header_crm flex_props justify-content-between",children:t.jsx("p",{className:"crm_title",children:"Otp Login Access"})}),t.jsx("div",{className:"bid_table",children:t.jsx("div",{className:"table-responsive",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"S.No."}),t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Email"}),t.jsx("th",{children:"Number"}),t.jsx("th",{children:"Role"}),t.jsx("th",{children:"Otp"}),t.jsx("th",{children:"Expired At"}),t.jsx("th",{children:"Send Otp"})]})}),t.jsx("tbody",{children:((d=i==null?void 0:i.data)==null?void 0:d.length)>0?i.data.map((s,c)=>{var a,r,e;return t.jsxs("tr",{children:[t.jsx("td",{children:c+1}),t.jsx("td",{children:s.userName}),t.jsx("td",{children:s.email}),t.jsx("td",{children:s.number||"-"}),t.jsx("td",{children:s.role}),t.jsx("td",{children:((a=s==null?void 0:s.otp)==null?void 0:a.value)||"-"}),t.jsx("td",{children:(r=s==null?void 0:s.otp)!=null&&r.expiresAt?u(s.otp.expiresAt).format("YYYY-MM-DD HH:mm:ss"):"-"}),t.jsx("td",{children:(e=s==null?void 0:s.otp)!=null&&e.value?t.jsx("button",{className:"btn btn-primary btn-sm text-nowrap",onClick:()=>m(s._id,s.email,s.otp.value),children:"Send Otp"}):"-"})]},s._id)}):t.jsx("tr",{children:t.jsx("td",{colSpan:"8",className:"text-center",children:t.jsx("h1",{children:"Not available"})})})})]})})})]})]})})};export{N as default};
