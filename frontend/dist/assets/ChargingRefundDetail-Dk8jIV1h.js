import{e as b,r as t,b as h,j as e}from"./index-DDoEHnfR.js";import{L as D}from"./Layout-Co7qzEc2.js";import{S as A}from"./SideBar-DCoEgSRU.js";import{D as p}from"./index.es-_Aq59fjB.js";/* empty css                         */import"./clsx-B-dksMZM.js";const R=()=>{const{agent:j}=b();console.log("Agents:",j);const[u,f]=t.useState([]),[l,c]=t.useState({agent:"",fromDate:null,toDate:null,transactionType:"",provider:""}),[m,g]=t.useState([]),[i,o]=t.useState(!1),[x,v]=t.useState([]);t.useEffect(()=>{y()},[]);const y=async()=>{try{const s=await h.get("/api/v1/auth/get-all-users");v(s.data.getAllusers.filter(a=>!a.isTrashed))}catch(s){console.error("Error fetching users:",s)}finally{o(!1)}};t.useEffect(()=>{(async()=>{try{const a=await h.get("/api/v1/ctmFlights/get-provider");a.data.success&&f(a.data.booking)}catch(a){console.error("Failed to fetch providers",a)}})()},[]);const d=s=>{const{name:a,value:r}=s.target;c(n=>({...n,[a]:r}))},N=async()=>{try{o(!0);const s=await h.post("/api/v1/ctmFlights/filter-charge-refunds",l);console.log("Filter Response:",s.data),g(s.data.data||[])}catch(s){console.error("Error applying filter:",s)}finally{o(!1)}};return e.jsx(D,{children:e.jsxs("main",{className:"crm_all_body d-flex",children:[e.jsx(A,{}),e.jsxs("div",{className:"container-fluid p-4",children:[e.jsx("h3",{className:"mb-3",children:"Charging Refund Details"}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"Agent"}),e.jsxs("select",{name:"agent",value:l.agent,onChange:d,className:"form-select",children:[e.jsx("option",{value:"",children:"Select Agent"}),x&&x.map(s=>e.jsx("option",{value:s._id,children:s.userName||s.agentuserName},s._id))]})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"From"}),e.jsx(p,{selected:l.fromDate,onChange:s=>c(a=>({...a,fromDate:s})),placeholderText:"Select Date",dateFormat:"MM-dd-yyyy",className:"form-control",maxDate:new Date})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"To"}),e.jsx(p,{selected:l.toDate,onChange:s=>c(a=>({...a,toDate:s})),placeholderText:"Select Date",dateFormat:"MM-dd-yyyy",className:"form-control",maxDate:new Date})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"Transaction Type"}),e.jsxs("select",{name:"transactionType",value:l.transactionType,onChange:d,className:"form-select",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"refund",children:"Refund Details"}),e.jsx("option",{value:"chargeBackDetails",children:"ChargeBack Details"})]})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{className:"form-label",children:"Provider"}),e.jsxs("select",{name:"provider",value:l.provider,onChange:d,className:"form-select",children:[e.jsx("option",{value:"",children:"Select Provider"}),u.filter(s=>s.providerStatus==="Active").map(s=>e.jsx("option",{value:s._id,children:s.provider},s._id))]})]}),e.jsx("div",{className:"col-md-3 align-self-end",children:e.jsx("button",{onClick:N,className:"btn btn-primary w-100",disabled:i,children:i?"Applying...":"Apply Filter"})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{children:"Results:"}),i?e.jsx("p",{children:"Loading..."}):m.length>0?e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Agent"}),e.jsx("th",{children:"Provider"}),e.jsx("th",{children:"Transaction Type"}),e.jsx("th",{children:"Created At"})]})}),e.jsx("tbody",{children:m.map((s,a)=>{var r,n;return e.jsxs("tr",{children:[e.jsx("td",{children:a+1}),e.jsx("td",{children:((r=s.agent)==null?void 0:r.userName)||s.agent.userName||"N/A"}),e.jsx("td",{children:((n=s.provider)==null?void 0:n.provider)||"N/A"}),e.jsx("td",{children:s.transactionType}),e.jsx("td",{children:new Date(s.createdAt).toLocaleString()})]},s._id)})})]}):e.jsx("p",{children:"No results found."})]})]})]})})};export{R as default};
