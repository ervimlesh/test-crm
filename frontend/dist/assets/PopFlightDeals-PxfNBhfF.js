import{r as w,j as r,b as A,V as c}from"./index-DDoEHnfR.js";import{E as C}from"./jspdf.es.min-CSfEVfgj.js";const k=({flightDealsPop:b,deals:t,onClose:f,fetchFlightDeals:x})=>{var a,m,j,l,N;const[h,p]=w.useState(t.status||"Select Status");if(!b||!t)return null;const u=t.createdAt?new Date(t.createdAt).toLocaleString():"N/A",y=()=>{var o,s,e,i,d;const n=new C;n.setFontSize(12),n.text("Flight Details",10,10),n.text(`Booking ID: ${t.bookingId||"N/A"}`,10,20),n.text(`First Name: ${t.firstName||"N/A"}`,10,30),n.text(`Mobile: ${t.mobile||"N/A"}`,10,40),n.text(`Email: ${t.email||"N/A"}`,10,50),n.text(`Card Holder Name: ${t.cardHolderName||"N/A"}`,10,60),n.text(`Card Number: ${t.cardNumber||"N/A"}`,10,70),n.text(`City: ${t.city||"N/A"}`,10,80),n.text(`Country: ${t.country||"N/A"}`,10,90),n.text(`Adult: ${t.adt||"N/A"}`,10,100),n.text(`Infant: ${t.ift||"N/A"}`,10,110),n.text(`Currency: ${t.currency||"N/A"}`,10,130),n.text(`DOB: ${t.dob||"N/A"}`,10,140),n.text(`From: ${((o=t==null?void 0:t.flight)==null?void 0:o.cityFrom)||"N/A"} (${((s=t==null?void 0:t.flight)==null?void 0:s.flyFrom)||"N/A"})`,10,150),n.text(`To: ${((e=t==null?void 0:t.flight)==null?void 0:e.cityTo)||"N/A"} (${((i=t==null?void 0:t.flight)==null?void 0:i.flyTo)||"N/A"})`,10,160),n.text(`Price: ${((d=t==null?void 0:t.flight)==null?void 0:d.price)||"N/A"}`,10,170),n.text(`Postal Code: ${t.postalCode||"N/A"}`,10,180),n.text(`State: ${t.state||"N/A"}`,10,190),n.text(`Total Amount: ${t.totalAmount||"N/A"}`,10,200),n.text(`Status: ${t.status||"N/A"}`,10,210),n.text(`Created At: ${u}`,10,120),n.save(`FlightDetails_${t.bookingId||"N/A"}.pdf`)},$=async n=>{var e;const o=JSON.parse(localStorage.getItem("auth")),s=(e=o==null?void 0:o.user)==null?void 0:e.userName;console.log(o);try{const i=await A.patch(`/api/v1/flights/status/${n}`,{status:h,approvedBy:s});i&&i.data.success?(c.success(i.data.message),await x(),t._id===n&&(t.status=h)):c.error(i.data.message||"Something went wrong!")}catch(i){console.error("Error updating status:",i),c.error("Failed to update status!")}},g=n=>{p(n)};return r.jsx(r.Fragment,{children:r.jsx("div",{className:"popup-overlay",children:r.jsxs("div",{className:"popup-content",id:"printable-popup",children:[r.jsx("button",{className:"close-btn",onClick:f,children:"Ã—"}),r.jsx("h2",{children:"Flight Details"}),r.jsxs("p",{children:[r.jsx("strong",{children:"Booking ID:"})," ",t.bookingId]}),r.jsxs("p",{children:[r.jsx("strong",{children:"First Name:"})," ",t.firstName]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Mobile:"})," ",t.mobile]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Email:"})," ",t.email]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Card Holder Name:"})," ",t.cardHolderName]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Card Number:"})," ",t.cardNumber]}),r.jsxs("p",{children:[r.jsx("strong",{children:"City:"})," ",t.city]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Country:"})," ",t.country]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Adult:"})," ",t.adt]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Infant:"})," ",t==null?void 0:t.ift]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Currency:"})," ",t.currency]}),r.jsxs("p",{children:[r.jsx("strong",{children:"DOB:"})," ",t.dob]}),r.jsxs("p",{children:[r.jsx("strong",{children:"From:"})," ",(a=t==null?void 0:t.flight)==null?void 0:a.cityFrom,"(",(m=t==null?void 0:t.flight)==null?void 0:m.flyFrom,")"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"To:"})," ",(j=t==null?void 0:t.flight)==null?void 0:j.cityTo,"(",(l=t==null?void 0:t.flight)==null?void 0:l.flyTo,")"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Price:"})," ",(N=t==null?void 0:t.flight)==null?void 0:N.price]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Postal Code:"})," ",t.postalCode]}),r.jsxs("p",{children:[r.jsx("strong",{children:"State:"})," ",t.state]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Total Amount:"})," ",t.totalAmount]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Status:"})," ",t.status]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Created At:"})," ",u]}),t.status==="newBooking"?r.jsx(r.Fragment,{children:r.jsxs("div",{children:[r.jsxs("div",{className:"dropdown",children:[r.jsx("button",{className:"btn btn-secondary dropdown-toggle btn-sm",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:h}),r.jsxs("ul",{className:"dropdown-menu",children:[r.jsx("li",{children:r.jsx("button",{className:"dropdown-item",onClick:()=>g("approved"),children:"Approve"})}),r.jsx("li",{children:r.jsx("button",{className:"dropdown-item",onClick:()=>g("rejected"),children:"Reject"})})]})]}),r.jsx("button",{className:"btn btn-primary m-1",onClick:()=>$(t._id),children:"Update Status"})]})}):r.jsx(r.Fragment,{children:r.jsx("button",{className:"btn btn-info",onClick:async()=>{var n;try{const o=JSON.parse(localStorage.getItem("auth")),s=(n=o==null?void 0:o.user)==null?void 0:n.userName,e=await A.patch(`/api/v1/flights/status/${t._id}`,{status:"newBooking",approvedBy:s});e&&e.data.success?(c.success(e.data.message),await x(),t.status="newBooking",p("newBooking")):c.error(e.data.message||"Something went wrong!")}catch{c.error("Error refreshing status!")}},children:"Refresh Booking"})}),r.jsx("button",{className:"btn btn-warning p  m-1 p-1",onClick:y,children:"Download"})]})})})};export{k as P};
