import{r as d,j as e,N as g,b as i,V as l}from"./index-DDoEHnfR.js";import{L as p}from"./Layout-Co7qzEc2.js";import{S as b}from"./SideBar-DCoEgSRU.js";const y=()=>{const[t,o]=d.useState({reducePercentage:"",reduceUrl:""}),[h,u]=d.useState([]),m=r=>{const{id:a,value:c}=r.target;o({...t,[a]:c})},x=async r=>{r.preventDefault();try{const a=await i.patch("/api/v1/flights/reduction-percentage",t);a.data.success?(l.success(a.data.message),o({reducePercentage:"",reduceUrl:""}),n()):alert("Failed to update reduction percentage.")}catch(a){console.error("Error updating reduction percentage:",a),alert("Failed to update reduction percentage. Please try again.")}},n=async()=>{var r;try{const a=await i.get("/api/v1/flights/get-reduction-percentage");a.data.success?u((r=a==null?void 0:a.data)==null?void 0:r.data):console.error("Failed to fetch current reduction percentage.")}catch(a){console.error("Error fetching current reduction percentage:",a)}};d.useEffect(()=>{n()},[]);const j=async r=>{var a,c;try{const s=await i.delete(`/api/v1/flights/delete-reduce-reduction/${r}`);(a=s==null?void 0:s.data)!=null&&a.success?(l.success((c=s==null?void 0:s.data)==null?void 0:c.message),n()):l.error("Failed to delete reduction.")}catch(s){console.error("Error deleting reduction:",s),l.error("An error occurred while deleting the reduction.")}};return e.jsx(p,{children:e.jsxs("div",{className:"d-flex",children:[e.jsx(b,{}),e.jsxs("div",{className:"flex-grow-1 p-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"text-center",children:"Reduce Price"}),e.jsxs("form",{onSubmit:x,className:"form_booking",children:[e.jsxs("div",{className:"form_booking",children:[e.jsxs("label",{htmlFor:"",children:["Reduce Amount ",e.jsx("span",{children:"*"})]}),e.jsx("div",{className:"form_input",children:e.jsx("input",{type:"Number",maxLength:"3",id:"reducePercentage",value:t.reducePercentage,onChange:m,required:!0,placeholder:"Enter reduction percentage",className:"form-control",min:"0",max:"100"})}),e.jsxs("div",{className:"col-md-9 mb-3",children:[e.jsx("label",{htmlFor:"reduceUrl",className:"form-label",children:"Reduce Url"}),e.jsxs("select",{id:"reduceUrl",className:"form-select",value:t.reduceUrl,onChange:m,required:!0,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"faresway.com",children:"Faresway"}),e.jsx("option",{value:"traveloways.com",children:"Traveloways"}),e.jsx("option",{value:"faresvilla.com",children:" Faresvilla"})]})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Submit"})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center p-2 bg-light",children:e.jsx("h6",{className:"m-1 p-1",children:"Current Price"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Reduction Percentage"}),e.jsx("th",{children:"Reduction Url"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:h.filter(r=>(r==null?void 0:r.reducePercentage)&&(r==null?void 0:r.reduceUrl)).length>0?h.filter(r=>(r==null?void 0:r.reducePercentage)&&(r==null?void 0:r.reduceUrl)).map((r,a)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[(r==null?void 0:r.reducePercentage)||"-"," %"]}),e.jsx("td",{children:(r==null?void 0:r.reduceUrl)||"-"}),e.jsxs("td",{className:"d-flex gap-2",children:[e.jsx(g,{to:`/astrivion/reduce-src-dest-details/${r._id}`,className:"btn btn-primary btn-sm",children:"Edit"}),e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>j(r._id),children:"Delete"})]})]},a)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No reduction data available"})})})]})})})]})]})]})})};export{y as default};
